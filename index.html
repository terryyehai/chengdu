<!doctype html>
<html lang="zh-Hant">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <title>æˆéƒ½æ·±åº¦æ—…éŠ 2026ï½œ9å¤©8å¤œï½œæ—…é€”æ—¥è¨˜</title>
  <meta name="description" content="2026å¹´æˆéƒ½9å¤©8å¤œæ·±åº¦æ—…éŠè¡Œç¨‹ï¼Œåœ‹æ³°èˆªç©ºé«˜é›„å‡ºç™¼ï¼Œå«ä¹å¯¨æºã€é»ƒé¾ã€é»ƒé¾æºªå¤é®ã€å¸‚å€ç¾é£Ÿæ–‡åŒ–ç­‰ç²¾å½©è¡Œç¨‹ã€‚" />
  <meta name="theme-color" content="#3B82F6" />
  <link rel="manifest" href="./manifest.json" />
  <link rel="icon" href="./icon-192.svg" type="image/svg+xml" />
  <link rel="apple-touch-icon" href="./icon-192.svg" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap"
    rel="stylesheet" />

  <!-- é«˜å¾·åœ°åœ–å®‰å…¨å¯†é‘°è¨­å®šï¼ˆå¿…é ˆåœ¨ SDK è¼‰å…¥å‰è¨­å®šï¼‰ -->
  <script>
    window._AMapSecurityConfig = {
      securityJsCode: "6906803561bf037e99aa8ceb1de31bee",
    };
  </script>
  <!-- é«˜å¾·åœ°åœ– JS API v2.0 -->
  <script
    src="https://webapi.amap.com/maps?v=2.0&key=2ff5910e40cf633abbe738e78c4e4160&plugin=AMap.Driving,AMap.Walking,AMap.Geolocation,AMap.InfoWindow,AMap.MarkerCluster"></script>

  <style>
    /* ===== å…¨åŸŸè¨­å®š ===== */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    :root {
      --amber: #f59e0b;
      --amber-dk: #d97706;
      --teal: #0d9488;
      --navy: #1e3a5f;
      --cream: #fff8f0;
      --card-bg: #ffffff;
      --text-main: #1e3a5f;
      --text-sub: #6b7280;
      --radius: 16px;
      --shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
    }

    body {
      font-family: "Plus Jakarta Sans", sans-serif;
      background: var(--cream);
      color: var(--text-main);
      max-width: 430px;
      margin: 0 auto;
      padding-bottom: 90px;
      -webkit-tap-highlight-color: transparent;
    }

    /* ===== è‹±é›„æ©«å¹… ===== */
    .hero {
      position: relative;
      height: 60vw;
      max-height: 320px;
      min-height: 240px;
      /* æš–è‰²æ¼¸å±¤èƒŒæ™¯ï¼Œæ­é…ç¾ä»£AIç”Ÿæˆçš„ç†Šè²“èˆ‡ç«¹å­åœ–ç‰‡ */
      background: url('images/panda_hero.png') center/cover no-repeat;
      overflow: hidden;
      border-radius: 0 0 32px 32px;
    }

    /* å¤§å‹ç†Šè²“ SVG æ’åœ– */
    .hero-bg-svg {
      position: absolute;
      bottom: -5px;
      right: -5px;
      width: 220px;
      height: 220px;
      opacity: 0.85;
      pointer-events: none;
      filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.15));
    }

    .hero-gradient {
      position: absolute;
      inset: 0;
      background: linear-gradient(to top,
          rgba(30, 58, 95, 0.95) 0%,
          rgba(30, 58, 95, 0.3) 60%,
          transparent 100%);
    }

    .hero-content {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 20px;
    }

    .hero-logo {
      position: absolute;
      top: 16px;
      left: 16px;
      font-size: 13px;
      font-weight: 700;
      color: rgba(255, 255, 255, 0.9);
      letter-spacing: 0.5px;
    }

    .hero-title {
      font-size: 28px;
      font-weight: 800;
      color: #fff;
      line-height: 1.2;
      margin-bottom: 6px;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    }

    .hero-date {
      font-size: 13px;
      color: rgba(255, 255, 255, 0.85);
      margin-bottom: 10px;
      font-weight: 500;
    }

    .hero-badges {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .badge {
      background: rgba(255, 255, 255, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.35);
      color: #fff;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      backdrop-filter: blur(6px);
    }

    .badge.amber {
      background: var(--amber);
      border-color: var(--amber);
    }

    /* ===== å€’æ•¸è¨ˆæ™‚å™¨ ===== */
    .countdown-timer {
      background: rgba(0, 0, 0, 0.4);
      border: 1px solid rgba(255, 255, 255, 0.3);
      color: #fff;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 700;
      backdrop-filter: blur(8px);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-top: 10px;
    }

    .countdown-timer .label {
      font-size: 11px;
      font-weight: 500;
      color: rgba(255, 255, 255, 0.85);
    }

    .countdown-timer .value {
      font-family: monospace;
      font-size: 15px;
      letter-spacing: 0.5px;
      color: var(--amber);
    }

    /* ===== çµ±è¨ˆåˆ— ===== */
    .stats-bar {
      background: var(--card-bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      margin: 14px 16px 0;
      padding: 14px 8px;
      display: flex;
      justify-content: space-around;
    }

    .stat-item {
      text-align: center;
      flex: 1;
    }

    .stat-icon {
      font-size: 18px;
    }

    .stat-value {
      font-size: 13px;
      font-weight: 700;
      color: var(--navy);
      display: block;
      margin-top: 2px;
    }

    .stat-label {
      font-size: 10px;
      color: var(--text-sub);
    }

    /* ===== é€šç”¨æ¿å¡Šæ¨™é¡Œ ===== */
    .section-header {
      padding: 20px 16px 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .section-header h2 {
      font-size: 17px;
      font-weight: 800;
      color: var(--navy);
    }

    .section-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--amber);
      flex-shrink: 0;
    }

    /* ===== æ—¥æœŸå¡ç‰‡ ===== */
    .day-cards {
      padding: 0 16px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .day-card {
      background: var(--card-bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      display: flex;
      align-items: stretch;
      overflow: hidden;
      text-decoration: none;
      color: inherit;
      transition:
        transform 0.15s ease,
        box-shadow 0.15s ease;
      cursor: pointer;
    }

    .day-card:active {
      transform: scale(0.98);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .day-card.disabled {
      opacity: 0.65;
      cursor: default;
    }

    .day-card.disabled:active {
      transform: none;
    }

    /* å·¦å´æ—¥æ•¸è‰²æ¢ */
    .day-accent {
      width: 54px;
      flex-shrink: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 2px;
      padding: 14px 0;
    }

    .day-accent .day-num {
      font-size: 18px;
      font-weight: 800;
      color: #fff;
    }

    .day-accent .day-label {
      font-size: 9px;
      font-weight: 600;
      color: rgba(255, 255, 255, 0.8);
    }

    .day-body {
      flex: 1;
      padding: 12px 12px 10px;
    }

    .day-meta {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 4px;
    }

    .day-date {
      font-size: 11px;
      color: var(--text-sub);
      font-weight: 500;
    }

    .day-theme {
      font-size: 14px;
      font-weight: 700;
      color: var(--navy);
      margin-bottom: 4px;
    }

    .day-image {
      width: 100%;
      height: 130px;
      border-radius: 10px;
      overflow: hidden;
      margin: 8px 0;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
    }

    .day-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: top;
      transition: transform 0.4s ease;
    }

    .day-card:hover .day-image img {
      transform: scale(1.05);
    }

    .day-hotel {
      font-size: 11px;
      color: var(--teal);
      font-weight: 600;
      margin-bottom: 5px;
    }

    .attraction-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      margin-bottom: 8px;
    }

    .tag {
      background: #f3f4f6;
      border-radius: 20px;
      padding: 3px 8px;
      font-size: 10px;
      color: var(--text-sub);
      font-weight: 500;
    }

    .day-transport {
      font-size: 11px;
      color: var(--text-sub);
    }

    .day-arrow {
      width: 40px;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-sub);
      font-size: 16px;
      padding-right: 4px;
    }

    .day-arrow-text {
      font-size: 11px;
      color: #9ca3af;
    }

    /* æ¯å¤©çš„å·¦å´è‰²æ¢é¡è‰²ï¼ˆ9å¤©é…è‰²æ–¹æ¡ˆï¼‰ */
    .accent-d1 {
      background: linear-gradient(135deg, #f59e0b, #d97706);
    }

    .accent-d2 {
      background: linear-gradient(135deg, #10b981, #059669);
    }

    .accent-d3 {
      background: linear-gradient(135deg, #3b82f6, #2563eb);
    }

    .accent-d4 {
      background: linear-gradient(135deg, #06b6d4, #0891b2);
    }

    .accent-d5 {
      background: linear-gradient(135deg, #8b5cf6, #6d28d9);
    }

    .accent-d6 {
      background: linear-gradient(135deg, #ec4899, #db2777);
    }

    .accent-d7 {
      background: linear-gradient(135deg, #f97316, #ea580c);
    }

    .accent-d8 {
      background: linear-gradient(135deg, #14b8a6, #0d9488);
    }

    .accent-d9 {
      background: linear-gradient(135deg, #ef4444, #dc2626);
    }

    /* ===== æ¶ç¥¨æ—¥æ›† ===== */
    .booking-section {
      padding: 0 16px;
      margin-bottom: 24px;
    }

    .booking-notice {
      background: #eff6ff;
      border: 1px solid #bfdbfe;
      border-radius: 12px;
      padding: 12px;
      margin-bottom: 16px;
      font-size: 11px;
      color: #1e3a8a;
      line-height: 1.5;
    }

    .booking-notice strong {
      color: #1d4ed8;
      font-size: 13px;
      display: block;
      margin-bottom: 4px;
    }

    .booking-timeline {
      display: flex;
      flex-direction: column;
      gap: 12px;
      position: relative;
    }

    .booking-timeline::before {
      content: '';
      position: absolute;
      top: 10px;
      bottom: 20px;
      left: 36px;
      width: 2px;
      background: #e5e7eb;
      z-index: 0;
    }

    .booking-item {
      display: flex;
      gap: 12px;
      position: relative;
      z-index: 1;
    }

    .bk-date-box {
      width: 74px;
      flex-shrink: 0;
      background: var(--card-bg);
      border: 2px solid var(--teal);
      border-radius: 10px;
      padding: 8px 0;
      text-align: center;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      align-self: flex-start;
      position: relative;
    }

    .bk-date-box::after {
      content: '';
      position: absolute;
      right: -8px;
      top: 15px;
      width: 6px;
      height: 6px;
      background: var(--teal);
      border-radius: 50%;
    }

    .bk-date-box.bk-danger {
      border-color: #ef4444;
    }

    .bk-date-box.bk-danger::after {
      background: #ef4444;
    }

    .bk-month {
      font-size: 10px;
      color: var(--teal);
      font-weight: 700;
      text-transform: uppercase;
    }

    .bk-danger .bk-month {
      color: #ef4444;
    }

    .bk-day {
      font-size: 18px;
      font-weight: 800;
      color: var(--navy);
      line-height: 1;
      margin-top: 2px;
    }

    .bk-content {
      flex: 1;
      background: var(--card-bg);
      border-radius: 12px;
      padding: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
      border: 1px solid #f3f4f6;
    }

    .bk-content.bk-content-danger {
      background: #fef2f2;
      border-color: #fecaca;
    }

    .bk-title {
      font-size: 14px;
      font-weight: 700;
      color: var(--navy);
      margin-bottom: 4px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .bk-platform {
      font-size: 11px;
      font-weight: 600;
      color: #059669;
      background: #d1fae5;
      padding: 2px 6px;
      border-radius: 4px;
      display: inline-block;
      margin-bottom: 6px;
    }

    .bk-desc {
      font-size: 11px;
      color: var(--text-sub);
      line-height: 1.4;
    }

    .bk-danger-tag {
      background: #ef4444;
      color: #fff;
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 10px;
      font-weight: 700;
    }

    .booking-reminder-btn {
      background: #eff6ff;
      border: 1px solid #3b82f6;
      color: #2563eb;
      font-size: 11px;
      font-weight: 700;
      padding: 4px 10px;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
      flex-shrink: 0;
      white-space: nowrap;
    }

    .booking-reminder-btn:hover {
      background: #3b82f6;
      color: #fff;
    }

    .booking-reminder-btn.active {
      background: #10b981;
      border-color: #059669;
      color: #fff;
    }

    body.dark-mode .booking-reminder-btn {
      background: #1e3a8a;
      border-color: #3b82f6;
      color: #bfdbfe;
    }

    body.dark-mode .booking-reminder-btn.active {
      background: #059669;
      border-color: #10b981;
      color: #fff;
    }

    /* ===== ä½å®¿ç¸½è¦½ ===== */
    .hotel-container {
      padding: 0 16px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .hotel-wrapper {
      position: relative;
    }

    .hotel-card {
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--shadow);
      padding: 12px 14px;
      display: flex;
      align-items: center;
      gap: 12px;
      border-left: 4px solid var(--teal);
      cursor: pointer;
      position: relative;
      transition: all 0.2s ease;
      z-index: 2;
    }

    .hotel-card:active {
      transform: scale(0.98);
    }

    .hotel-icon {
      font-size: 28px;
      flex-shrink: 0;
    }

    .hotel-info {
      flex: 1;
    }

    .hotel-name {
      font-size: 14px;
      font-weight: 700;
      color: var(--navy);
      margin-bottom: 2px;
    }

    .hotel-nights {
      font-size: 11px;
      color: var(--teal);
      font-weight: 600;
      margin-bottom: 2px;
    }

    .hotel-desc {
      font-size: 11px;
      color: var(--text-sub);
      line-height: 1.4;
    }

    .hotel-arrow {
      font-size: 14px;
      color: var(--text-sub);
      transition: transform 0.3s ease;
      padding-left: 8px;
    }

    /* ä½å®¿å±•é–‹é¢æ¿ */
    .hotel-detail-panel {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease, padding 0.3s ease, margin 0.3s ease;
      background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);
      border-radius: 0 0 12px 12px;
      margin-top: -10px;
      /* æ‹‰è¿‘èˆ‡å¡ç‰‡çš„è·é›¢ */
      z-index: 1;
    }

    .hotel-detail-panel.open {
      max-height: 350px;
      padding: 22px 14px 14px;
      /* ä¸Šç•™ç™½çµ¦ä¸Šé¢å¡ç‰‡è“‹éçš„é™°å½± */
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05) inset;
    }

    .hotel-detail-panel .detail-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 8px;
    }

    .hotel-detail-panel .detail-item {
      background: rgba(255, 255, 255, 0.85);
      border-radius: 8px;
      padding: 8px 10px;
      border: 1px solid rgba(0, 0, 0, 0.05);
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }

    .hotel-detail-panel .detail-icon {
      font-size: 14px;
      flex-shrink: 0;
      margin-top: 1px;
    }

    .hotel-detail-panel .detail-text {
      font-size: 12px;
      color: var(--navy);
      font-weight: 500;
      line-height: 1.4;
    }

    .hotel-map-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      background: var(--teal);
      color: #fff;
      font-size: 12px;
      font-weight: 700;
      padding: 8px 16px;
      border-radius: 8px;
      text-decoration: none;
      margin-top: 10px;
      width: 100%;
      text-align: center;
      transition: background 0.2s;
    }

    .hotel-map-btn:hover {
      background: #0f766e;
    }

    /* ===== èˆªç­è³‡è¨Š ===== */
    .flight-section {
      padding: 0 16px;
    }

    .flight-card {
      background: var(--card-bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      margin-bottom: 12px;
    }

    .flight-card-header {
      padding: 12px 14px;
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 700;
      font-size: 14px;
      color: #fff;
    }

    .flight-card-header.outbound {
      background: linear-gradient(135deg, #10b981, #059669);
    }

    .flight-card-header.inbound {
      background: linear-gradient(135deg, #3b82f6, #2563eb);
    }

    .flight-leg {
      padding: 12px 14px;
      display: flex;
      align-items: center;
      gap: 10px;
      border-bottom: 1px solid #f3f4f6;
    }

    .flight-leg:last-child {
      border-bottom: none;
    }

    .flight-leg-icon {
      font-size: 24px;
      flex-shrink: 0;
    }

    .flight-leg-info {
      flex: 1;
    }

    .flight-route {
      font-size: 14px;
      font-weight: 700;
      color: var(--navy);
      margin-bottom: 2px;
    }

    .flight-detail {
      font-size: 11px;
      color: var(--text-sub);
      line-height: 1.5;
    }

    .flight-time {
      text-align: right;
      flex-shrink: 0;
    }

    .flight-time-main {
      font-size: 16px;
      font-weight: 800;
      color: var(--navy);
    }

    .flight-time-sub {
      font-size: 10px;
      color: var(--text-sub);
    }

    .flight-layover {
      background: #fffbeb;
      border-left: 3px solid #f59e0b;
      margin: 0 14px;
      padding: 8px 12px;
      font-size: 12px;
      color: #92400e;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    /* èˆªç­è¿½è¹¤æŒ‰éˆ• */
    .track-flight-btn {
      background: rgba(13, 148, 136, 0.1);
      border: 1px solid var(--teal);
      color: var(--teal);
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      margin-top: 6px;
    }

    .track-flight-btn:hover:not(:disabled) {
      background: var(--teal);
      color: #fff;
    }

    .track-flight-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    /* æŸ¥è©¢è©³æƒ…æŒ‰éˆ• */
    .query-flight-btn {
      background: rgba(59, 130, 246, 0.1);
      border: 1px solid #3b82f6;
      color: #3b82f6;
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      margin-top: 4px;
      margin-left: 6px;
    }

    .query-flight-btn:hover:not(:disabled) {
      background: #3b82f6;
      color: #fff;
    }

    .query-flight-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    /* èˆªç­è©³æƒ…å±•é–‹é¢æ¿ */
    .flight-detail-panel {
      max-height: 0;
      overflow: hidden;
      transition:
        max-height 0.4s ease,
        padding 0.3s ease;
      background: linear-gradient(135deg, #f0f9ff 0%, #eff6ff 100%);
      border-top: 1px solid #e0e7ff;
    }

    .flight-detail-panel.open {
      max-height: 400px;
      padding: 12px 14px;
    }

    .flight-detail-panel .detail-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }

    .flight-detail-panel .detail-item {
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(8px);
      border-radius: 10px;
      padding: 8px 10px;
      border: 1px solid rgba(0, 0, 0, 0.05);
    }

    .flight-detail-panel .detail-item.full-width {
      grid-column: 1 / -1;
    }

    .flight-detail-panel .detail-label {
      font-size: 10px;
      color: var(--text-sub);
      font-weight: 500;
      margin-bottom: 2px;
    }

    .flight-detail-panel .detail-value {
      font-size: 14px;
      font-weight: 700;
      color: var(--navy);
    }

    .flight-detail-panel .detail-value.status-active {
      color: #059669;
    }

    .flight-detail-panel .detail-value.status-landed {
      color: #3b82f6;
    }

    .flight-detail-panel .detail-value.status-cancelled {
      color: #dc2626;
    }

    .flight-detail-panel .detail-value.status-scheduled {
      color: #d97706;
    }

    .flight-detail-panel .detail-value.has-delay {
      color: #dc2626;
    }

    .flight-detail-panel .panel-note {
      margin-top: 8px;
      font-size: 10px;
      color: var(--text-sub);
      text-align: center;
    }

    /* ===== é«˜å¾·åœ°åœ–å€å¡Š ===== */
    .map-section {
      padding: 0 16px;
    }

    /* ===== å¤©æ°£å€å¡Š ===== */
    .weather-cards {
      padding: 0 16px;
      display: flex;
      gap: 10px;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }

    .weather-cards::-webkit-scrollbar {
      display: none;
    }

    .weather-card {
      background: var(--card-bg);
      border-radius: 14px;
      box-shadow: var(--shadow);
      padding: 14px;
      min-width: 130px;
      flex-shrink: 0;
      text-align: center;
      transition: transform 0.15s;
    }

    .weather-card:active {
      transform: scale(0.97);
    }

    .weather-card .wc-city {
      font-size: 13px;
      font-weight: 700;
      color: var(--navy);
      margin-bottom: 6px;
    }

    .weather-card .wc-icon {
      font-size: 32px;
      line-height: 1;
      margin-bottom: 4px;
    }

    .weather-card .wc-temp {
      font-size: 22px;
      font-weight: 800;
      color: var(--navy);
      margin-bottom: 2px;
    }

    .weather-card .wc-desc {
      font-size: 11px;
      color: var(--text-sub);
      font-weight: 500;
      margin-bottom: 6px;
    }

    .weather-card .wc-details {
      display: flex;
      justify-content: center;
      gap: 8px;
      font-size: 10px;
      color: var(--text-sub);
    }

    .weather-card .wc-loading {
      font-size: 12px;
      color: var(--text-sub);
      padding: 10px 0;
    }

    .map-section {
      position: relative;
      margin: 0 16px 24px;
    }

    #amap-overview {
      width: 100%;
      height: 220px;
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: var(--shadow);
    }

    .map-filters {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 100;
      display: flex;
      gap: 6px;
    }

    .map-filter-btn {
      background: rgba(255, 255, 255, 0.9);
      border: 1px solid #E5E7EB;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 700;
      color: #4B5563;
      cursor: pointer;
      backdrop-filter: blur(4px);
      transition: all 0.2s;
    }

    .map-filter-btn.active {
      background: var(--teal);
      color: white;
      border-color: var(--teal);
    }

    body.dark-mode .map-filter-btn {
      background: rgba(30, 45, 74, 0.9);
      border-color: #374151;
      color: #D1D5DB;
    }

    body.dark-mode .map-filter-btn.active {
      background: var(--teal);
      color: white;
      border-color: var(--teal);
    }

    /* ===== æ—…éŠæç¤º ===== */
    .tips-card {
      margin: 0 16px;
      background: #fffbeb;
      border: 1px solid #fde68a;
      border-radius: var(--radius);
      padding: 14px;
    }

    .tip-item {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      margin-bottom: 10px;
    }

    .tip-item:last-child {
      margin-bottom: 0;
    }

    .tip-icon {
      font-size: 18px;
      flex-shrink: 0;
    }

    .tip-text {
      font-size: 13px;
      color: #92400e;
      line-height: 1.5;
    }

    /* ===== åº•éƒ¨å°è¦½åˆ— ===== */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      max-width: 430px;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-top: 1px solid rgba(0, 0, 0, 0.07);
      display: flex;
      justify-content: space-around;
      padding: 10px 0 20px;
      z-index: 100;
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 3px;
      flex: 1;
      cursor: pointer;
      text-decoration: none;
    }

    .nav-icon {
      font-size: 22px;
    }

    .nav-label {
      font-size: 10px;
      font-weight: 600;
      color: var(--text-sub);
    }

    .nav-item.active .nav-label {
      color: var(--amber);
    }

    .nav-item.active .nav-icon {
      filter: drop-shadow(0 0 3px rgba(245, 158, 11, 0.5));
    }

    body.dark-mode .expense-panel {
      background: var(--card-bg);
    }

    body.dark-mode .expense-panel .ep-total-card,
    body.dark-mode .expense-panel .ep-rate-card {
      background: rgba(30, 45, 74, 0.85);
      border-color: rgba(255, 255, 255, 0.05);
    }

    body.dark-mode .expense-item {
      background: var(--cream);
      border-color: #2d3a52;
    }

    body.dark-mode .expense-item-amount {
      color: #F59E0B;
    }

    /* ===== è¨˜å¸³èˆ‡åŒ¯ç‡é¢æ¿ Modal ===== */
    .expense-panel {
      background: var(--card-bg);
      width: 100%;
      max-width: 430px;
      border-radius: 24px 24px 0 0;
      padding: 20px 20px 32px;
      max-height: 85vh;
      overflow-y: auto;
      animation: slideUp 0.3s ease;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .ep-rate-card {
      background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
      border-radius: 16px;
      padding: 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: #92400e;
    }

    .ep-rate-title {
      font-size: 13px;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .ep-rate-value {
      font-size: 18px;
      font-weight: 800;
    }

    .ep-rate-refresh {
      background: #F59E0B;
      color: white;
      border: none;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 12px;
    }

    .ep-input-group {
      display: flex;
      gap: 10px;
    }

    .ep-input-wrap {
      flex: 1;
      position: relative;
    }

    .ep-input-wrap span {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      font-weight: 700;
      color: var(--text-sub);
    }

    .ep-input {
      width: 100%;
      padding: 12px 12px 12px 36px;
      border-radius: 12px;
      border: 1px solid #D1D5DB;
      font-size: 16px;
      font-weight: 600;
      background: var(--cream);
      color: var(--text-main);
      box-sizing: border-box;
      outline: none;
    }

    .ep-input:focus {
      border-color: var(--teal);
    }

    .ep-input-desc {
      width: 100%;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid #D1D5DB;
      font-size: 14px;
      background: var(--cream);
      color: var(--text-main);
      box-sizing: border-box;
      outline: none;
    }

    .ep-btn-submit {
      width: 100%;
      padding: 14px;
      border-radius: 12px;
      background: var(--teal);
      color: white;
      font-weight: 700;
      font-size: 15px;
      border: none;
      cursor: pointer;
      transition: background 0.2s;
    }

    .ep-btn-submit:active {
      background: #0F766E;
    }

    .ep-total-card {
      background: #F0FDF4;
      border: 1px solid #BBF7D0;
      border-radius: 16px;
      padding: 16px;
      text-align: center;
    }

    .ep-total-title {
      font-size: 13px;
      color: #166534;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .ep-total-twd {
      font-size: 28px;
      font-weight: 800;
      color: #15803D;
    }

    .ep-total-rmb {
      font-size: 14px;
      color: #166534;
      opacity: 0.8;
      font-weight: 600;
      margin-top: 4px;
    }

    .expense-list {
      max-height: 200px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 8px;
    }

    .expense-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 12px;
      background: #F9FAFB;
      border-radius: 10px;
      border: 1px solid #E5E7EB;
    }

    .expense-item-info {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .expense-item-desc {
      font-size: 14px;
      font-weight: 600;
      color: var(--navy);
    }

    .expense-item-time {
      font-size: 11px;
      color: var(--text-sub);
    }

    .expense-item-amount {
      text-align: right;
    }

    .expense-item-twd {
      font-size: 16px;
      font-weight: 800;
      color: var(--teal);
    }

    .expense-item-rmb {
      font-size: 12px;
      color: var(--text-sub);
      font-weight: 600;
    }

    .expense-item-delete {
      background: #FEE2E2;
      color: #EF4444;
      border: none;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      cursor: pointer;
      margin-left: 10px;
    }

    /* ===== åŒ…åŒ…æ‰“åŒ…æ¸…å–® ===== */
    .packing-progress-bg {
      width: 100%;
      height: 6px;
      background: #E5E7EB;
      border-radius: 3px;
      overflow: hidden;
      margin-bottom: 16px;
    }

    .packing-progress-bar {
      height: 100%;
      background: var(--teal);
      width: 0%;
      transition: width 0.4s ease;
    }

    .packing-progress-text {
      font-size: 12px;
      color: var(--text-sub);
      font-weight: 600;
      text-align: right;
      margin-top: -10px;
      margin-bottom: 12px;
    }

    .packing-content {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .packing-category {
      border: 1px solid #E5E7EB;
      border-radius: 12px;
      overflow: hidden;
    }

    .packing-category-title {
      background: #F9FAFB;
      padding: 10px 12px;
      font-size: 14px;
      font-weight: 700;
      color: var(--navy);
      border-bottom: 1px solid #E5E7EB;
    }

    .packing-items {
      padding: 8px 12px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .packing-item {
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
    }

    .packing-checkbox {
      width: 18px;
      height: 18px;
      border-radius: 4px;
      border: 2px solid #D1D5DB;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .packing-checkbox.checked {
      background: var(--teal);
      border-color: var(--teal);
    }

    .packing-checkbox.checked::after {
      content: 'âœ“';
      color: white;
      font-size: 12px;
      font-weight: bold;
    }

    .packing-label {
      font-size: 14px;
      color: var(--text-main);
      font-weight: 500;
      transition: color 0.2s;
    }

    .packing-item.checked .packing-label {
      color: var(--text-sub);
      text-decoration: line-through;
    }

    /* æ·±è‰²æ¨¡å¼æ”¯æ´ */
    body.dark-mode .packing-category {
      border-color: rgba(255, 255, 255, 0.1);
    }

    body.dark-mode .packing-category-title {
      background: rgba(255, 255, 255, 0.05);
      border-bottom-color: rgba(255, 255, 255, 0.1);
      color: var(--text-main);
    }

    body.dark-mode .packing-progress-bg {
      background: #374151;
    }

    body.dark-mode .packing-checkbox {
      border-color: #4B5563;
    }

    body.dark-mode .packing-title {
      color: var(--text-main);
    }

    /* ===== æ·±è‰²æ¨¡å¼ ===== */
    body.dark-mode {
      --cream: #1a1a2e;
      --card-bg: #16213e;
      --text-main: #e0e0e0;
      --text-sub: #9ca3af;
      --navy: #e0e0e0;
      --shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
    }

    body.dark-mode .hero {
      background: linear-gradient(135deg,
          #0f0c29 0%,
          #302b63 40%,
          #f59e0b 100%);
    }

    body.dark-mode .bottom-nav {
      background: rgba(22, 33, 62, 0.95);
      border-top-color: rgba(255, 255, 255, 0.08);
    }

    body.dark-mode .tag {
      background: #1e2d4a;
      color: #9ca3af;
    }

    body.dark-mode .tips-card {
      background: #1e2d4a;
      border-color: #2d3a52;
    }

    body.dark-mode .tip-text {
      color: #d4a05a;
    }

    body.dark-mode .flight-detail-panel {
      background: linear-gradient(135deg, #1a2744 0%, #16213e 100%);
      border-top-color: #2d3a52;
    }

    body.dark-mode .flight-detail-panel .detail-item {
      background: rgba(30, 45, 74, 0.85);
      border-color: rgba(255, 255, 255, 0.05);
    }

    body.dark-mode .flight-layover {
      background: #1e2d4a;
      color: #d4a05a;
    }

    /* å­—å‹å¤§å°èª¿æ•´ */
    body.font-small {
      font-size: 13px;
    }

    body.font-medium {
      font-size: 16px;
    }

    body.font-large {
      font-size: 19px;
    }

    /* ===== è¨­å®šé¢æ¿ Modal ===== */
    .settings-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(4px);
      z-index: 200;
      display: none;
      justify-content: center;
      align-items: flex-end;
    }

    .settings-overlay.open {
      display: flex;
    }

    .settings-panel {
      background: var(--card-bg);
      width: 100%;
      max-width: 430px;
      border-radius: 24px 24px 0 0;
      padding: 20px 20px 32px;
      max-height: 85vh;
      overflow-y: auto;
      animation: slideUp 0.3s ease;
    }

    @keyframes slideUp {
      from {
        transform: translateY(100%);
      }

      to {
        transform: translateY(0);
      }
    }

    .settings-panel .sp-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 18px;
    }

    .settings-panel .sp-title {
      font-size: 18px;
      font-weight: 800;
      color: var(--navy);
    }

    .settings-panel .sp-close {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: none;
      background: #f3f4f6;
      font-size: 16px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }

    body.dark-mode .settings-panel .sp-close {
      background: #2d3a52;
      color: #e0e0e0;
    }

    .settings-panel .sp-close:hover {
      background: #e5e7eb;
    }

    .settings-panel .sp-group {
      margin-bottom: 18px;
    }

    .settings-panel .sp-group-title {
      font-size: 12px;
      font-weight: 700;
      color: var(--text-sub);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 10px;
    }

    .settings-panel .sp-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 14px;
      background: var(--cream);
      border-radius: 12px;
      margin-bottom: 8px;
    }

    .settings-panel .sp-row-label {
      font-size: 14px;
      font-weight: 600;
      color: var(--navy);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* Toggle é–‹é—œ */
    .toggle-switch {
      position: relative;
      width: 48px;
      height: 26px;
      background: #d1d5db;
      border-radius: 13px;
      cursor: pointer;
      transition: background 0.3s;
      border: none;
      padding: 0;
    }

    .toggle-switch.active {
      background: var(--teal);
    }

    .toggle-switch::after {
      content: "";
      position: absolute;
      top: 3px;
      left: 3px;
      width: 20px;
      height: 20px;
      background: #fff;
      border-radius: 50%;
      transition: transform 0.3s;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
    }

    .toggle-switch.active::after {
      transform: translateX(22px);
    }

    body.dark-mode .expense-panel .ep-total-card,
    body.dark-mode .expense-panel .ep-rate-card {
      background: rgba(30, 45, 74, 0.85);
      border-color: rgba(255, 255, 255, 0.05);
    }

    body.dark-mode .expense-item {
      background: var(--cream);
      border-color: #2d3a52;
    }

    body.dark-mode .expense-item-amount {
      color: #F59E0B;
    }

    /* ===== è¨˜å¸³èˆ‡åŒ¯ç‡é¢æ¿ Modal ===== */
    .expense-panel {
      background: var(--card-bg);
      width: 100%;
      max-width: 430px;
      border-radius: 24px 24px 0 0;
      padding: 20px 20px 32px;
      max-height: 85vh;
      overflow-y: auto;
      animation: slideUp 0.3s ease;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .ep-rate-card {
      background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
      border-radius: 16px;
      padding: 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: #92400e;
    }

    .ep-rate-title {
      font-size: 13px;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .ep-rate-value {
      font-size: 18px;
      font-weight: 800;
    }

    .ep-rate-refresh {
      background: #F59E0B;
      color: white;
      border: none;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 12px;
    }

    .ep-input-group {
      display: flex;
      gap: 10px;
    }

    .ep-input-wrap {
      flex: 1;
      position: relative;
    }

    .ep-input-wrap span {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      font-weight: 700;
      color: var(--text-sub);
    }

    .ep-input {
      width: 100%;
      padding: 12px 12px 12px 36px;
      border-radius: 12px;
      border: 1px solid #D1D5DB;
      font-size: 16px;
      font-weight: 600;
      background: var(--cream);
      color: var(--text-main);
      box-sizing: border-box;
      outline: none;
    }

    .ep-input:focus {
      border-color: var(--teal);
    }

    .ep-input-desc {
      width: 100%;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid #D1D5DB;
      font-size: 14px;
      background: var(--cream);
      color: var(--text-main);
      box-sizing: border-box;
      outline: none;
    }

    .ep-btn-submit {
      width: 100%;
      padding: 14px;
      border-radius: 12px;
      background: var(--teal);
      color: white;
      font-weight: 700;
      font-size: 15px;
      border: none;
      cursor: pointer;
      transition: background 0.2s;
    }

    .ep-btn-submit:active {
      background: #0F766E;
    }

    .ep-total-card {
      background: #F0FDF4;
      border: 1px solid #BBF7D0;
      border-radius: 16px;
      padding: 16px;
      text-align: center;
    }

    .ep-total-title {
      font-size: 13px;
      color: #166534;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .ep-total-twd {
      font-size: 28px;
      font-weight: 800;
      color: #15803D;
    }

    .ep-total-rmb {
      font-size: 14px;
      color: #166534;
      opacity: 0.8;
      font-weight: 600;
      margin-top: 4px;
    }

    .expense-list {
      max-height: 200px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 8px;
    }

    .expense-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 12px;
      background: #F9FAFB;
      border-radius: 10px;
      border: 1px solid #E5E7EB;
    }

    .expense-item-info {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .expense-item-desc {
      font-size: 14px;
      font-weight: 600;
      color: var(--navy);
    }

    .expense-item-time {
      font-size: 11px;
      color: var(--text-sub);
    }

    .expense-item-amount {
      text-align: right;
    }

    .expense-item-twd {
      font-size: 16px;
      font-weight: 800;
      color: var(--teal);
    }

    .expense-item-rmb {
      font-size: 12px;
      color: var(--text-sub);
      font-weight: 600;
    }

    .expense-item-delete {
      background: #FEE2E2;
      color: #EF4444;
      border: none;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      cursor: pointer;
      margin-left: 10px;
    }

    /* å­—å‹å¤§å°é¸æ“‡å™¨ */
    .font-size-selector {
      display: flex;
      gap: 6px;
    }

    .font-size-selector button {
      padding: 5px 12px;
      border-radius: 8px;
      border: 1px solid #d1d5db;
      background: transparent;
      color: var(--text-sub);
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .font-size-selector button.active {
      background: var(--amber);
      color: #fff;
      border-color: var(--amber);
    }

    /* æ“ä½œæŒ‰éˆ• */
    .sp-action-btn {
      width: 100%;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      background: var(--cream);
      color: var(--navy);
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin-bottom: 8px;
    }

    .sp-action-btn:hover {
      background: #f3f4f6;
    }

    .sp-action-btn.danger {
      color: #dc2626;
      border-color: #fecaca;
    }

    .sp-action-btn.danger:hover {
      background: #fef2f2;
    }

    .sp-version {
      text-align: center;
      font-size: 11px;
      color: var(--text-sub);
      margin-top: 10px;
    }

    /* ===== å¾®å‹•æ•ˆèˆ‡æ»¾å‹•å‹•ç•« (Motion & Microinteractions) ===== */
    .fade-up {
      opacity: 0;
      transform: translateY(24px);
      transition: opacity 0.6s cubic-bezier(0.16, 1, 0.3, 1), transform 0.6s cubic-bezier(0.16, 1, 0.3, 1);
      will-change: opacity, transform;
    }

    .fade-up.visible {
      opacity: 1;
      transform: translateY(0);
    }

    /* æ‡¸åœèˆ‡é»æ“Šåé¥‹å„ªåŒ– */
    .day-card,
    .tl-card,
    .hotel-card,
    .tips-card,
    .weather-card {
      transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1), box-shadow 0.3s cubic-bezier(0.16, 1, 0.3, 1) !important;
    }

    .day-card:hover,
    .tl-card:hover,
    .hotel-card:hover {
      transform: translateY(-6px);
      box-shadow: 0 16px 32px rgba(0, 0, 0, 0.12) !important;
    }

    body.dark-mode .day-card:hover,
    body.dark-mode .tl-card:hover,
    body.dark-mode .hotel-card:hover {
      box-shadow: 0 16px 32px rgba(0, 0, 0, 0.5) !important;
    }
  </style>

  <style>
    .lucide {
      width: 1em;
      height: 1em;
      vertical-align: middle;
    }

    .nav-icon .lucide {
      width: 24px;
      height: 24px;
    }

    .stat-icon .lucide {
      width: 20px;
      height: 20px;
      margin-bottom: 4px;
      color: var(--teal, #0D9488);
    }

    .sp-title .lucide {
      width: 20px;
      height: 20px;
      margin-right: 6px;
    }

    h2 .lucide {
      width: 24px;
      height: 24px;
      margin-right: 8px;
    }

    .tip-icon .lucide,
    .tip-ic .lucide {
      width: 18px;
      height: 18px;
      margin-top: 2px;
    }

    /* ===== å¾®å‹•æ•ˆèˆ‡æ»¾å‹•å‹•ç•« (Motion & Microinteractions) ===== */
    .fade-up {
      opacity: 0;
      transform: translateY(24px);
      transition: opacity 0.6s cubic-bezier(0.16, 1, 0.3, 1), transform 0.6s cubic-bezier(0.16, 1, 0.3, 1);
      will-change: opacity, transform;
    }

    .fade-up.visible {
      opacity: 1;
      transform: translateY(0);
    }

    /* æ‡¸åœèˆ‡é»æ“Šåé¥‹å„ªåŒ– */
    .day-card,
    .tl-card,
    .hotel-card,
    .tips-card,
    .weather-card {
      transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1), box-shadow 0.3s cubic-bezier(0.16, 1, 0.3, 1) !important;
    }

    .day-card:hover,
    .tl-card:hover,
    .hotel-card:hover {
      transform: translateY(-6px);
      box-shadow: 0 16px 32px rgba(0, 0, 0, 0.12) !important;
    }

    body.dark-mode .day-card:hover,
    body.dark-mode .tl-card:hover,
    body.dark-mode .hotel-card:hover {
      box-shadow: 0 16px 32px rgba(0, 0, 0, 0.5) !important;
    }
  </style>
  <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>
  <!-- ===== è‹±é›„æ©«å¹…ï¼ˆçœŸå¯¦ç…§ç‰‡èƒŒæ™¯ + æ–‡åŒ–æ’åœ–è£é£¾ï¼‰ ===== -->
  <div class="hero">

    <div class="hero-gradient"></div>
    <div class="hero-content">
      <div class="hero-logo">ğŸ—ºï¸ æ—…é€”æ—¥è¨˜</div>
      <h1 class="hero-title">æˆéƒ½æ·±åº¦æ—…éŠ</h1>
      <p class="hero-date">2026 å¹´ 5æœˆ16æ—¥ â€” 5æœˆ24æ—¥</p>
      <div class="hero-badges">
        <span class="badge amber">ğŸ• 9å¤©8å¤œ</span>
        <span class="badge">âœˆï¸ å››å· æˆéƒ½</span>
        <span class="badge">ğŸ”ï¸ ä¹å¯¨æº Â· é»ƒé¾</span>
        <span class="badge">ğŸ‘¥ 2 äººåŒè¡Œ</span>
      </div>
      <div class="countdown-timer" id="trip-countdown" style="display: none">
        <span class="label">â³ è·é›¢å‡ºç™¼é‚„å‰©</span>
        <span class="value" id="countdown-value">--</span>
      </div>
    </div>
  </div>

  <!-- ===== æ—…ç¨‹çµ±è¨ˆåˆ— ===== -->
  <div class="stats-bar">
    <div class="stat-item">
      <span class="stat-icon"><i data-lucide="calendar-days"></i></span>
      <span class="stat-value">9å¤©</span>
      <span class="stat-label">è¡Œç¨‹å¤©æ•¸</span>
    </div>
    <div class="stat-item">
      <span class="stat-icon"><i data-lucide="hotel"></i></span>
      <span class="stat-value">5å®¶</span>
      <span class="stat-label">ä½å®¿</span>
    </div>
    <div class="stat-item">
      <span class="stat-icon"><i data-lucide="map-pin"></i></span>
      <span class="stat-value">20+</span>
      <span class="stat-label">æ™¯é»</span>
    </div>
    <div class="stat-item">
      <span class="stat-icon"><i data-lucide="car"></i></span>
      <span class="stat-value">~800km</span>
      <span class="stat-label">ç¸½é‡Œç¨‹</span>
    </div>
    <div class="stat-item">
      <span class="stat-icon"><i data-lucide="plane"></i></span>
      <span class="stat-value">é«˜é›„â†”æˆéƒ½</span>
      <span class="stat-label">èˆªç­</span>
    </div>
  </div>

  <!-- ===== æ—…éŠåœ°é»å³æ™‚å¤©æ°£ ===== -->
  <div class="section-header">
    <div class="section-dot" style="background: #3b82f6"></div>
    <h2><i data-lucide="cloud-sun"></i> å³æ™‚å¤©æ°£</h2>
  </div>
  <div class="weather-cards" id="weather-container">
    <div class="weather-card" id="weather-chengdu">
      <div class="wc-city">æˆéƒ½å¸‚å€</div>
      <div class="wc-loading">â˜• è¼‰å…¥ä¸­...</div>
    </div>
    <div class="weather-card" id="weather-jiuzhai">
      <div class="wc-city">ä¹å¯¨æº</div>
      <div class="wc-loading">â˜• è¼‰å…¥ä¸­...</div>
    </div>
    <div class="weather-card" id="weather-huanglong">
      <div class="wc-city">é»ƒé¾</div>
      <div class="wc-loading">â˜• è¼‰å…¥ä¸­...</div>
    </div>
    <div class="weather-card" id="weather-dujiangyan">
      <div class="wc-city">éƒ½æ±Ÿå °</div>
      <div class="wc-loading">â˜• è¼‰å…¥ä¸­...</div>
    </div>
  </div>

  <!-- ç§»é™¤åŸæœ¬çš„è¡Œå…§æ‰“åŒ…æ¸…å–® -->

  <!-- ===== ç¥¨å‹™é ç´„èˆ‡æ¶ç¥¨æ—¥æ›†ç§»å‹•è‡³ modal ===== -->

  <!-- ===== æ¯æ—¥è¡Œç¨‹å¡ç‰‡ï¼ˆ9å¤©ï¼‰ ===== -->
  <div class="section-header">
    <div class="section-dot"></div>
    <h2>è¡Œç¨‹ç¸½è¦½</h2>
  </div>

  <div class="day-cards">
    <!-- Day 1 -->
    <a class="day-card" href="day1.html">
      <div class="day-accent accent-d1">
        <span class="day-num">1</span>
        <span class="day-label">DAY</span>
      </div>
      <div class="day-body">
        <div class="day-meta">
          <span class="day-date">5æœˆ16æ—¥ï¼ˆé€±äº”ï¼‰</span>
        </div>
        <div class="day-theme">æŠµé”æˆéƒ½ Â· å¸‚å€åˆé«”é©— ğŸ™ï¸</div>
        <div class="day-image">
          <img src="images/Day1.png" alt="Day 1" loading="lazy">
        </div>
        <div class="day-hotel">ğŸ¨ æ˜¥ç†™è·¯åœ‹éš›é‡‘èä¸­å¿ƒäºæœµé…’åº—</div>
        <div class="attraction-tags">
          <span class="tag">æ˜¥ç†™è·¯</span>
          <span class="tag">å¤ªå¤é‡Œ</span>
          <span class="tag">IFSç†Šè²“</span>
          <span class="tag">ç«é‹</span>
        </div>
        <div class="day-transport">
          âœˆï¸ æŠµé” &nbsp;ğŸš• æ©Ÿå ´â†’é£¯åº— &nbsp;ğŸš¶ æ­¥è¡Œ
        </div>
      </div>
      <div class="day-arrow">â€º</div>
    </a>

    <!-- Day 2 -->
    <a class="day-card" href="day2.html">
      <div class="day-accent accent-d2">
        <span class="day-num">2</span>
        <span class="day-label">DAY</span>
      </div>
      <div class="day-body">
        <div class="day-meta">
          <span class="day-date">5æœˆ17æ—¥ï¼ˆé€±å…­ï¼‰</span>
        </div>
        <div class="day-theme">é»ƒé¾æºªå¤é®ä¸€æ—¥éŠ ğŸ®</div>
        <div class="day-image">
          <img src="images/Day2.png" alt="Day 2" loading="lazy">
        </div>
        <div class="day-hotel">ğŸ¨ æ˜¥ç†™è·¯åœ‹éš›é‡‘èä¸­å¿ƒäºæœµé…’åº—ï¼ˆåŒä¸Šï¼‰</div>
        <div class="attraction-tags">
          <span class="tag">é»ƒé¾æºªå¤é®</span>
          <span class="tag">å¤è¡—æ¼«æ­¥</span>
          <span class="tag">ç•¶åœ°å°åƒ</span>
        </div>
        <div class="day-transport">ğŸš• æ»´æ»´ / åŒ…è»Š &nbsp;ğŸš¶ æ­¥è¡Œ</div>
      </div>
      <div class="day-arrow">â€º</div>
    </a>

    <!-- Day 3 -->
    <a class="day-card" href="day3.html">
      <div class="day-accent accent-d3">
        <span class="day-num">3</span>
        <span class="day-label">DAY</span>
      </div>
      <div class="day-body">
        <div class="day-meta">
          <span class="day-date">5æœˆ18æ—¥ï¼ˆé€±æ—¥ï¼‰</span>
        </div>
        <div class="day-theme">é«˜éµç›´å¥”ä¹å¯¨ Â· è—æ—é¢¨æƒ… ğŸ”ï¸</div>
        <div class="day-image">
          <img src="images/Day3.png" alt="Day 3" loading="lazy">
        </div>
        <div class="day-hotel">ğŸ¨ å››å­£é›²éš±Â·äº”æ†å…¨æ°§æ°‘å®¿ï¼ˆå½­è±æ‘ï¼‰</div>
        <div class="attraction-tags">
          <span class="tag">å·é’é«˜éµ</span>
          <span class="tag">ä¹å¯¨æºå£</span>
          <span class="tag">è—å¼ç«é‹</span>
          <span class="tag">åƒå¤æƒ…</span>
        </div>
        <div class="day-transport">é«˜éµ &nbsp;ğŸšŒ å¤§å·´ &nbsp;ğŸš¶ æ­¥è¡Œ</div>
      </div>
      <div class="day-arrow">â€º</div>
    </a>

    <!-- Day 4 -->
    <a class="day-card" href="day4.html">
      <div class="day-accent accent-d4">
        <span class="day-num">4</span>
        <span class="day-label">DAY</span>
      </div>
      <div class="day-body">
        <div class="day-meta">
          <span class="day-date">5æœˆ19æ—¥ï¼ˆé€±ä¸€ï¼‰</span>
        </div>
        <div class="day-theme">ä¸€é€²ä¹å¯¨æº Â· ç«¥è©±ä¸–ç•Œ ğŸ’</div>
        <div class="day-image">
          <img src="images/Day4.png" alt="Day 4" loading="lazy">
        </div>
        <div class="day-hotel">ğŸ¨ å››å­£é›²éš±Â·äº”æ†å…¨æ°§æ°‘å®¿ï¼ˆåŒä¸Šï¼‰</div>
        <div class="attraction-tags">
          <span class="tag">äº”èŠ±æµ·</span>
          <span class="tag">çç ç˜ç€‘å¸ƒ</span>
          <span class="tag">äº”å½©æ± </span>
          <span class="tag">è«¾æ—¥æœ—ç€‘å¸ƒ</span>
        </div>
        <div class="day-transport">ğŸšŒ æ™¯å€è§€å…‰è»Š &nbsp;ğŸš¶ æ£§é“æ­¥è¡Œ</div>
      </div>
      <div class="day-arrow">â€º</div>
    </a>

    <!-- Day 5 -->
    <a class="day-card" href="day5.html">
      <div class="day-accent accent-d5">
        <span class="day-num">5</span>
        <span class="day-label">DAY</span>
      </div>
      <div class="day-body">
        <div class="day-meta">
          <span class="day-date">5æœˆ20æ—¥ï¼ˆé€±äºŒï¼‰</span>
        </div>
        <div class="day-theme">äºŒé€²ä¹å¯¨æº Â· ç§»å®¿å·ä¸»å¯º ğŸ•ï¸</div>
        <div class="day-image">
          <img src="images/Day5.png" alt="Day 5" loading="lazy">
        </div>
        <div class="day-hotel">ğŸ¨ é›²èµ·Â·è¿¦å¢ƒ è—å¼å¥¢äº«æ°‘å®¿</div>
        <div class="attraction-tags">
          <span class="tag">ä¹å¯¨æºè£œè€ƒ</span>
          <span class="tag">å·ä¸»å¯ºé®</span>
          <span class="tag">è—å¼æ°‘å®¿</span>
        </div>
        <div class="day-transport">ğŸšŒ æ™¯å€è»Š &nbsp;ğŸš• æ‹¼è»Š</div>
      </div>
      <div class="day-arrow">â€º</div>
    </a>

    <!-- Day 6 -->
    <a class="day-card" href="day6.html">
      <div class="day-accent accent-d6">
        <span class="day-num">6</span>
        <span class="day-label">DAY</span>
      </div>
      <div class="day-body">
        <div class="day-meta">
          <span class="day-date">5æœˆ21æ—¥ï¼ˆé€±ä¸‰ï¼‰</span>
        </div>
        <div class="day-theme">é»ƒé¾éˆ£åŒ–æ±  Â· è¿”å›æˆéƒ½ ğŸ‰</div>
        <div class="day-image">
          <img src="images/Day6.png" alt="Day 6" loading="lazy">
        </div>
        <div class="day-hotel">ğŸ¨ å‡±ç‰¹éº—äºå‰µæ„ä¸»é¡Œé£¯åº—å…¬å¯“</div>
        <div class="attraction-tags">
          <span class="tag">é»ƒé¾æ™¯å€</span>
          <span class="tag">äº”å½©æ± </span>
          <span class="tag">ç´¢é“çºœè»Š</span>
          <span class="tag">é«˜éµè¿”è“‰</span>
        </div>
        <div class="day-transport">ğŸš• åŒ…è»Š &nbsp;ğŸš¡ çºœè»Š &nbsp;ğŸš„ é«˜éµ</div>
      </div>
      <div class="day-arrow">â€º</div>
    </a>

    <!-- Day 7 -->
    <a class="day-card" href="day7.html">
      <div class="day-accent accent-d7">
        <span class="day-num">7</span>
        <span class="day-label">DAY</span>
      </div>
      <div class="day-body">
        <div class="day-meta">
          <span class="day-date">5æœˆ22æ—¥ï¼ˆé€±å››ï¼‰</span>
        </div>
        <div class="day-theme">ç†Šè²“è°· Â· éƒ½æ±Ÿå °æ°´åˆ©å¥‡è¹Ÿ ğŸ¼</div>
        <div class="day-image">
          <img src="images/Day7.png" alt="Day 7" loading="lazy">
        </div>
        <div class="day-hotel">ğŸ¨ å‡±ç‰¹éº—äºå‰µæ„ä¸»é¡Œé£¯åº—å…¬å¯“ï¼ˆåŒä¸Šï¼‰</div>
        <div class="attraction-tags">
          <span class="tag">ç†Šè²“è°·</span>
          <span class="tag">éƒ½æ±Ÿå °</span>
          <span class="tag">å—æ©‹å¤œæ™¯</span>
        </div>
        <div class="day-transport">ğŸš„ åŸéš›é«˜éµ &nbsp; åŒ…è»Š</div>
      </div>
      <div class="day-arrow">â€º</div>
    </a>

    <!-- Day 8 -->
    <a class="day-card" href="day8.html">
      <div class="day-accent accent-d8">
        <span class="day-num">8</span>
        <span class="day-label">DAY</span>
      </div>
      <div class="day-body">
        <div class="day-meta">
          <span class="day-date">5æœˆ23æ—¥ï¼ˆé€±äº”ï¼‰</span>
        </div>
        <div class="day-theme">æ¢ç§˜ä¸‰æ˜Ÿå † Â· ç§»å‹•è‡³æ©Ÿå ´ ğŸ›ï¸</div>
        <div class="day-image">
          <img src="images/Day8.png" alt="Day 8" loading="lazy">
        </div>
        <div class="day-hotel">ğŸ¨ å¤©åºœç©ºæ¸¯æ‚…äº«é£¯åº—ï¼ˆå¤©åºœæ©Ÿå ´æ—ï¼‰</div>
        <div class="attraction-tags">
          <span class="tag">ä¸‰æ˜Ÿå †åšç‰©é¤¨</span>
          <span class="tag">é’éŠ…ç¥æ¨¹</span>
          <span class="tag">é»ƒé‡‘é¢å…·</span>
        </div>
        <div class="day-transport">ğŸš„ é«˜éµ &nbsp; åœ°éµ18è™Ÿç·š</div>
      </div>
      <div class="day-arrow">â€º</div>
    </a>

    <!-- Day 9 -->
    <a class="day-card" href="day9.html">
      <div class="day-accent accent-d9">
        <span class="day-num">9</span>
        <span class="day-label">DAY</span>
      </div>
      <div class="day-body">
        <div class="day-meta">
          <span class="day-date">5æœˆ24æ—¥ï¼ˆé€±å…­ï¼‰</span>
        </div>
        <div class="day-theme">å‘Šåˆ¥æˆéƒ½ Â· è¿”å›æº«æš–çš„å®¶ âœˆï¸</div>
        <div class="day-image">
          <img src="images/Day9.png" alt="Day 9" loading="lazy">
        </div>
        <div class="day-hotel">
          âœˆï¸ CX917 08:10 â†’ é¦™æ¸¯ â†’ CX458 â†’ é«˜é›„ 18:05
        </div>
        <div class="attraction-tags">
          <span class="tag">å¤©åºœæ©Ÿå ´</span>
          <span class="tag">é¦™æ¸¯è½‰æ©Ÿ</span>
          <span class="tag">å…ç¨…è³¼ç‰©</span>
          <span class="tag">å›å®¶</span>
        </div>
        <div class="day-transport">ğŸšŒ é£¯åº—æ¥é§ &nbsp;âœˆï¸ åœ‹æ³°èˆªç©º</div>
      </div>
      <div class="day-arrow">â€º</div>
    </a>
  </div>

  <!-- ===== ä½å®¿ç¸½è¦½ ===== -->
  <div class="section-header">
    <div class="section-dot" style="background: var(--teal)"></div>
    <h2>ğŸ¨ ä½å®¿ç¸½è¦½</h2>
  </div>

  <div class="hotel-container">
    <!-- Hotel 1 -->
    <div class="hotel-wrapper">
      <div class="hotel-card" onclick="toggleHotelDetail(this)">
        <div class="hotel-icon">ğŸŒ†</div>
        <div class="hotel-info">
          <div class="hotel-name">æ˜¥ç†™è·¯åœ‹éš›é‡‘èä¸­å¿ƒäºæœµé…’åº—</div>
          <div class="hotel-nights">ğŸ“… Day 1â€“2ï¼ˆ5/16-17ï¼Œ2æ™šï¼‰</div>
          <div class="hotel-desc">ä½æ–¼æ˜¥ç†™è·¯/å¤ªå¤é‡Œå•†åœˆï¼Œé€›è¡—åƒç«é‹è¶…æ–¹ä¾¿</div>
        </div>
        <div class="hotel-arrow">â–¼</div>
      </div>
      <div class="hotel-detail-panel">
        <div class="detail-grid">
          <div class="detail-item">
            <div class="detail-icon">ğŸ“</div>
            <div class="detail-text">åœ°å€ï¼šæˆéƒ½éŒ¦æ±Ÿå€ç´…æ˜Ÿè·¯äºŒæ®µ70è™Ÿä¸»æ¨“å››å·å ±æ¥­é›†åœ˜å¤§å»ˆæ—</div>
          </div>
          <div class="detail-item">
            <div class="detail-icon">ğŸ“</div>
            <div class="detail-text">é›»è©±ï¼š+86-28-82120666</div>
          </div>
          <div class="detail-item">
            <div class="detail-icon">â°</div>
            <div class="detail-text">å…¥ä½æ™‚é–“ï¼š16:00 å¾Œ<br>é€€æˆ¿æ™‚é–“ï¼š14:00 å‰</div>
          </div>
        </div>
        <a href="https://uri.amap.com/search?keyword=äºæœµé…’åº—(æˆéƒ½æ˜¥ç†™è·¯åœ‹éš›é‡‘èä¸­å¿ƒåº—)&center=104.08,30.65" target="_blank"
          class="hotel-map-btn">
          ğŸ—ºï¸ é–‹å•Ÿé«˜å¾·åœ°åœ–
        </a>
      </div>
    </div>

    <!-- Hotel 2 -->
    <div class="hotel-wrapper">
      <div class="hotel-card" onclick="toggleHotelDetail(this)">
        <div class="hotel-icon">ğŸ”ï¸</div>
        <div class="hotel-info">
          <div class="hotel-name">å››å­£é›²éš±Â·äº”æ†å…¨æ°§æ°‘å®¿</div>
          <div class="hotel-nights">ğŸ“… Day 3â€“4ï¼ˆ5/18-19ï¼Œ2æ™šï¼‰</div>
          <div class="hotel-desc">ä½æ–¼ä¹å¯¨æºå½­è±æ‘ï¼Œè¿‘æ™¯å€å…¥å£ï¼Œé«˜åŸæ°§å§</div>
        </div>
        <div class="hotel-arrow">â–¼</div>
      </div>
      <div class="hotel-detail-panel">
        <div class="detail-grid">
          <div class="detail-item">
            <div class="detail-icon">ğŸ“</div>
            <div class="detail-text">åœ°å€ï¼šå››å·ä¹å¯¨æºå½­è±æ‘48è™Ÿ</div>
          </div>
          <div class="detail-item">
            <div class="detail-icon">ğŸ“</div>
            <div class="detail-text">é›»è©±ï¼š+86-18111755277</div>
          </div>
          <div class="detail-item">
            <div class="detail-icon">â°</div>
            <div class="detail-text">å…¥ä½æ™‚é–“ï¼š12:00 å¾Œ<br>é€€æˆ¿æ™‚é–“ï¼š14:00 å‰</div>
          </div>
        </div>
        <a href="https://uri.amap.com/search?keyword=å››å­£äº‘éšäº”æ’å…¨æ°§æ°‘å®¿" target="_blank" class="hotel-map-btn">
          ğŸ—ºï¸ é–‹å•Ÿé«˜å¾·åœ°åœ–
        </a>
      </div>
    </div>

    <!-- Hotel 3 -->
    <div class="hotel-wrapper">
      <div class="hotel-card" onclick="toggleHotelDetail(this)">
        <div class="hotel-icon">ğŸ•ï¸</div>
        <div class="hotel-info">
          <div class="hotel-name">é›²èµ·Â·è¿¦å¢ƒ è—å¼å¥¢äº«æ°‘å®¿</div>
          <div class="hotel-nights">ğŸ“… Day 5ï¼ˆ5/20ï¼Œ1æ™šï¼‰</div>
          <div class="hotel-desc">ä½æ–¼å·ä¸»å¯ºï¼Œæ–¹ä¾¿éš”å¤©å‰å¾€é»ƒé¾æ™¯å€</div>
        </div>
        <div class="hotel-arrow">â–¼</div>
      </div>
      <div class="hotel-detail-panel">
        <div class="detail-grid">
          <div class="detail-item">
            <div class="detail-icon">ğŸ“</div>
            <div class="detail-text">åœ°å€ï¼šå››å·æ¾æ½˜å·ä¸»å¯ºé®å‚³å­æºæ‘1çµ„44è™Ÿé™„1è™Ÿ</div>
          </div>
          <div class="detail-item">
            <div class="detail-icon">ğŸ“</div>
            <div class="detail-text">é›»è©±ï¼š+86-13281872333</div>
          </div>
          <div class="detail-item">
            <div class="detail-icon">â°</div>
            <div class="detail-text">å…¥ä½æ™‚é–“ï¼š14:00 å¾Œ<br>é€€æˆ¿æ™‚é–“ï¼š12:00 å‰</div>
          </div>
        </div>
        <a href="https://uri.amap.com/search?keyword=äº‘èµ·è¿¦å¢ƒ" target="_blank" class="hotel-map-btn">
          ğŸ—ºï¸ é–‹å•Ÿé«˜å¾·åœ°åœ–
        </a>
      </div>
    </div>

    <!-- Hotel 4 -->
    <div class="hotel-wrapper">
      <div class="hotel-card" onclick="toggleHotelDetail(this)">
        <div class="hotel-icon">ğŸ¨</div>
        <div class="hotel-info">
          <div class="hotel-name">å‡±ç‰¹éº—äºå‰µæ„ä¸»é¡Œé£¯åº—å…¬å¯“</div>
          <div class="hotel-nights">ğŸ“… Day 6â€“7ï¼ˆ5/21-22ï¼Œ2æ™šï¼‰</div>
          <div class="hotel-desc">å›åˆ°æ˜¥ç†™å¤ªå¤é‡Œå•†åœˆï¼Œæ©Ÿèƒ½ä¾¿åˆ©</div>
        </div>
        <div class="hotel-arrow">â–¼</div>
      </div>
      <div class="hotel-detail-panel">
        <div class="detail-grid">
          <div class="detail-item">
            <div class="detail-icon">ğŸ“</div>
            <div class="detail-text">åœ°å€ï¼šå››å·æˆéƒ½éŒ¦æ±Ÿå€å—ç´—å¸½è¡—95è™Ÿæ™¶èåŒ¯å…¬å¯“</div>
          </div>
          <div class="detail-item">
            <div class="detail-icon">ğŸ“</div>
            <div class="detail-text">é›»è©±ï¼š+86-18113021433</div>
          </div>
          <div class="detail-item">
            <div class="detail-icon">â°</div>
            <div class="detail-text">å…¥ä½æ™‚é–“ï¼š14:00 å¾Œ<br>é€€æˆ¿æ™‚é–“ï¼š12:00 å‰</div>
          </div>
        </div>
        <a href="https://uri.amap.com/search?keyword=å‡¯ç‰¹ä¸½äºšåˆ›æ„ä¸»é¢˜é…’åº—å…¬å¯“(æ˜¥ç†™è·¯å¤ªå¤é‡Œåº—)" target="_blank" class="hotel-map-btn">
          ğŸ—ºï¸ é–‹å•Ÿé«˜å¾·åœ°åœ–
        </a>
      </div>
    </div>

    <!-- Hotel 5 -->
    <div class="hotel-wrapper">
      <div class="hotel-card" onclick="toggleHotelDetail(this)">
        <div class="hotel-icon">âœˆï¸</div>
        <div class="hotel-info">
          <div class="hotel-name">å¤©åºœç©ºæ¸¯æ‚…äº«é£¯åº—</div>
          <div class="hotel-nights">ğŸ“… Day 8ï¼ˆ5/23ï¼Œ1æ™šï¼‰</div>
          <div class="hotel-desc">å¤©åºœæ©Ÿå ´æ—ï¼Œç‚ºéš”å¤© 08:10 æ—©ç­æ©Ÿåšæº–å‚™</div>
        </div>
        <div class="hotel-arrow">â–¼</div>
      </div>
      <div class="hotel-detail-panel">
        <div class="detail-grid">
          <div class="detail-item">
            <div class="detail-icon">ğŸ“</div>
            <div class="detail-text">åœ°å€ï¼šå››å·ç°¡é™½é›²æ‚…è·¯2è™Ÿ</div>
          </div>
          <div class="detail-item">
            <div class="detail-icon">ğŸ“</div>
            <div class="detail-text">é›»è©±ï¼š+86-28-86907777</div>
          </div>
          <div class="detail-item">
            <div class="detail-icon">â°</div>
            <div class="detail-text">å…¥ä½æ™‚é–“ï¼š12:00 å¾Œ<br>é€€æˆ¿æ™‚é–“ï¼š12:00 å‰</div>
          </div>
        </div>
        <a href="https://uri.amap.com/search?keyword=å¤©åºœç©ºæ¸¯æ‚¦äº«é…’åº—" target="_blank" class="hotel-map-btn">
          ğŸ—ºï¸ é–‹å•Ÿé«˜å¾·åœ°åœ–
        </a>
      </div>
    </div>
  </div>

  <!-- ===== èˆªç­è³‡è¨Š ===== -->
  <div class="section-header">
    <div class="section-dot" style="background: #3b82f6"></div>
    <h2><i data-lucide="plane"></i> èˆªç­è³‡è¨Š</h2>
  </div>

  <div class="flight-section">
    <!-- å»ç¨‹ -->
    <div class="flight-card">
      <div class="flight-card-header outbound">
        ğŸŸ¢ å»ç¨‹ Â· 2026/05/16ï¼ˆé€±äº”ï¼‰
      </div>
      <div class="flight-leg">
        <div class="flight-leg-icon">ğŸ›«</div>
        <div class="flight-leg-info">
          <div class="flight-route">é«˜é›„ KHH â†’ é¦™æ¸¯ HKG</div>
          <div class="flight-detail">åœ‹æ³°èˆªç©º CX449 Â· ç¶“æ¿Ÿè‰™</div>
          <div>
            <button class="track-flight-btn" id="track-btn-CPA449"
              onclick="trackFlight('CPA449', 21.0, 113.8, 23.5, 121.0)">
              âœˆï¸ è¿½è¹¤èˆªç­
            </button>
            <button class="query-flight-btn" id="query-btn-CX449" onclick="queryFlightDetails('CX449')">
              ğŸ“‹ æŸ¥è©¢è©³æƒ…
            </button>
          </div>
        </div>
        <div class="flight-time">
          <div class="flight-time-main">07:30</div>
          <div class="flight-time-sub">â†’ 09:10</div>
        </div>
      </div>
      <div class="flight-detail-panel" id="panel-CX449"></div>
      <div class="flight-layover">â³ é¦™æ¸¯åœ‹éš›æ©Ÿå ´è½‰æ©Ÿ Â· åœç•™ 50 åˆ†é˜</div>
      <div class="flight-leg">
        <div class="flight-leg-icon">âœˆï¸</div>
        <div class="flight-leg-info">
          <div class="flight-route">é¦™æ¸¯ HKG â†’ æˆéƒ½ CTU</div>
          <div class="flight-detail">åœ‹æ³°èˆªç©º CX986 Â· ç¶“æ¿Ÿè‰™</div>
          <div>
            <button class="track-flight-btn" id="track-btn-CPA986"
              onclick="trackFlight('CPA986', 22.0, 103.0, 31.0, 114.5)">
              âœˆï¸ è¿½è¹¤èˆªç­
            </button>
            <button class="query-flight-btn" id="query-btn-CX986" onclick="queryFlightDetails('CX986')">
              ğŸ“‹ æŸ¥è©¢è©³æƒ…
            </button>
          </div>
        </div>
        <div class="flight-time">
          <div class="flight-time-main">10:00</div>
          <div class="flight-time-sub">â†’ 12:40</div>
        </div>
      </div>
      <div class="flight-detail-panel" id="panel-CX986"></div>
    </div>

    <!-- å›ç¨‹ -->
    <div class="flight-card">
      <div class="flight-card-header inbound">
        ğŸ”µ å›ç¨‹ Â· 2026/05/24ï¼ˆé€±å…­ï¼‰
      </div>
      <div class="flight-leg">
        <div class="flight-leg-icon">ğŸ›«</div>
        <div class="flight-leg-info">
          <div class="flight-route">æˆéƒ½ CTU â†’ é¦™æ¸¯ HKG</div>
          <div class="flight-detail">åœ‹æ³°èˆªç©º CX917</div>
          <div>
            <button class="track-flight-btn" id="track-btn-CPA917"
              onclick="trackFlight('CPA917', 22.0, 103.0, 31.0, 114.5)">
              âœˆï¸ è¿½è¹¤èˆªç­
            </button>
            <button class="query-flight-btn" id="query-btn-CX917" onclick="queryFlightDetails('CX917')">
              ğŸ“‹ æŸ¥è©¢è©³æƒ…
            </button>
          </div>
        </div>
        <div class="flight-time">
          <div class="flight-time-main">08:10</div>
          <div class="flight-time-sub">â†’ 11:10</div>
        </div>
      </div>
      <div class="flight-detail-panel" id="panel-CX917"></div>
      <div class="flight-layover">
        â³ é¦™æ¸¯åœ‹éš›æ©Ÿå ´è½‰æ©Ÿ Â· åœç•™ 5 å°æ™‚ 25 åˆ†é˜
      </div>
      <div class="flight-leg">
        <div class="flight-leg-icon">ğŸ </div>
        <div class="flight-leg-info">
          <div class="flight-route">é¦™æ¸¯ HKG â†’ é«˜é›„ KHH</div>
          <div class="flight-detail">åœ‹æ³°èˆªç©º CX458</div>
          <div>
            <button class="track-flight-btn" id="track-btn-CPA458"
              onclick="trackFlight('CPA458', 21.0, 113.8, 23.5, 121.0)">
              âœˆï¸ è¿½è¹¤èˆªç­
            </button>
            <button class="query-flight-btn" id="query-btn-CX458" onclick="queryFlightDetails('CX458')">
              ğŸ“‹ æŸ¥è©¢è©³æƒ…
            </button>
          </div>
        </div>
        <div class="flight-time">
          <div class="flight-time-main">16:35</div>
          <div class="flight-time-sub">â†’ 18:05 æŠµé”</div>
        </div>
      </div>
      <div class="flight-detail-panel" id="panel-CX458"></div>
    </div>
  </div>

  <!-- ===== é«˜å¾·åœ°åœ–ï¼šå…¨ç¨‹æ™¯é»ç¸½è¦½ ===== -->
  <div class="section-header">
    <div class="section-dot" style="background: var(--teal)"></div>
    <h2>æ™¯é»åœ°åœ–ç¸½è¦½</h2>
  </div>
  <div class="map-section">
    <div class="map-filters">
      <button class="map-filter-btn active" onclick="filterMap('all', this)">ğŸ—ºï¸ å…¨éƒ¨</button>
      <button class="map-filter-btn" onclick="filterMap('food', this)">ğŸœ ç¾é£Ÿ</button>
      <button class="map-filter-btn" onclick="filterMap('shopping', this)">ğŸ›ï¸ è³¼ç‰©</button>
    </div>
    <div id="amap-overview"></div>
  </div>

  <!-- ===== æ—…éŠæç¤º ===== -->
  <div class="section-header">
    <div class="section-dot" style="background: #f87171"></div>
    <h2>æ—…éŠå°æç¤º</h2>
  </div>
  <div class="tips-card">
    <div class="tip-item">
      <span class="tip-icon"><i data-lucide="mountain"></i></span>
      <span class="tip-text">ä¹å¯¨æº/é»ƒé¾æµ·æ‹” 3000m+ï¼Œå»ºè­°æå‰æœç”¨ç´…æ™¯å¤©é é˜²é«˜å±±ç—‡ã€‚</span>
    </div>
    <div class="tip-item">
      <span class="tip-icon"><i data-lucide="coins"></i></span>
      <span class="tip-text">å»ºè­°å‚™å¸¶å°‘é‡ç¾é‡‘ï¼Œéƒ¨åˆ†å°åƒæ”¤èˆ‡å¤è¡—åº—å®¶ä¸æ¥å—åˆ·å¡ã€‚</span>
    </div>
    <div class="tip-item">
      <span class="tip-icon"><i data-lucide="thermometer"></i></span>
      <span class="tip-text">5æœˆæˆéƒ½å¸‚å€ 20-30Â°Cï¼Œä½†ä¹å¯¨æº/é»ƒé¾åƒ… 5-15Â°Cï¼Œå‹™å¿…æº–å‚™ä¿æš–å¤–å¥—ã€‚</span>
    </div>
    <div class="tip-item">
      <span class="tip-icon"><i data-lucide="smartphone"></i></span>
      <span class="tip-text">ä¸‹è¼‰æ”¯ä»˜å¯¶æˆ–å¾®ä¿¡æ”¯ä»˜ï¼Œçµ•å¤§å¤šæ•¸æ™¯é»ã€é¤å»³ã€äº¤é€šå‡ä½¿ç”¨ QR
        ç¢¼ä»˜æ¬¾ã€‚</span>
    </div>
    <div class="tip-item">
      <span class="tip-icon"></span>
      <span class="tip-text">æˆéƒ½å¾€ä¹å¯¨æºè»Šç¨‹ç´„ 8 å°æ™‚ï¼Œå»ºè­°æº–å‚™æšˆè»Šè—¥ã€é›¶é£Ÿèˆ‡å……é›»è¨­å‚™ã€‚</span>
    </div>
  </div>

  <!-- åº•éƒ¨é–“è· -->
  <div style="height: 16px"></div>

  <!-- ===== åº•éƒ¨å°è¦½åˆ— ===== -->
  <nav class="bottom-nav">
    <a class="nav-item active" href="index.html">
      <span class="nav-icon"><i data-lucide="map"></i></span>
      <span class="nav-label">è¡Œç¨‹</span>
    </a>
    <a class="nav-item" href="#amap-overview">
      <span class="nav-icon"><i data-lucide="map-pin"></i></span>
      <span class="nav-label">åœ°åœ–</span>
    </a>
    <a class="nav-item" href="javascript:void(0)" onclick="openPacking()">
      <span class="nav-icon"><i data-lucide="backpack"></i></span>
      <span class="nav-label">æ‰“åŒ…</span>
    </a>
    <a class="nav-item" href="javascript:void(0)" onclick="openBooking()">
      <span class="nav-icon"><i data-lucide="ticket"></i></span>
      <span class="nav-label">æ¶ç¥¨</span>
    </a>
    <a class="nav-item" href="javascript:void(0)" onclick="openExpense()">
      <span class="nav-icon"><i data-lucide="calculator"></i></span>
      <span class="nav-label">è¨˜å¸³</span>
    </a>
    <a class="nav-item" href="javascript:void(0)" onclick="openSettings()">
      <span class="nav-icon"><i data-lucide="settings"></i></span>
      <span class="nav-label">è¨­å®š</span>
    </a>
  </nav>

  <!-- ===== æ¶ç¥¨æ—¥æ›† Modal ===== -->
  <div class="settings-overlay" id="booking-overlay" onclick="if(event.target===this) closeBooking()">
    <div class="expense-panel">
      <div class="sp-header" style="margin-bottom:10px">
        <div class="sp-title"><i data-lucide="ticket"></i> æ¶ç¥¨æ—¥æ›†</div>
        <button class="sp-close" onclick="closeBooking()">âœ•</button>
      </div>

      <div class="booking-section"
        style="padding:0; margin-bottom:0; max-height:60vh; overflow-y:auto; padding-right:4px;">
        <div class="booking-notice">
          <strong>ğŸ“ æ¶ç¥¨å‰ç½®ä½œæ¥­ï¼ˆå‡ºç™¼å‰ä¸€å€‹æœˆå‹™å¿…å®Œæˆï¼‰</strong>
          â€¢ <b>å¯¦åèªè­‰ï¼š</b>ä¸‹è¼‰ã€Œéµè·¯ 12306ã€App ä¸¦å®Œæˆå°èƒè­‰èªè­‰ï¼›ç¢ºèªå¾®ä¿¡æ”¯ä»˜ç¶å®šå¥½ä¿¡ç”¨å¡ã€‚<br>
          â€¢ <b>é å»ºè¯çµ¡äººï¼š</b>åœ¨æ‰€æœ‰å¾®ä¿¡å°ç¨‹åºä¸­æå‰è¨»å†Šï¼Œå°‡åŒè¡Œè¦ªå‹çš„ã€Œå§“åã€å°èƒè­‰è™Ÿã€æ‰‹æ©Ÿè™Ÿã€åŠ å…¥å¸¸ç”¨åå–®ã€‚ä¸€éµå¸¶å…¥æ‰èƒ½ç§’æ®ºï¼
        </div>

        <div class="booking-timeline">
          <!-- 5/04 é«˜éµå»ç¨‹ -->
          <div class="booking-item">
            <div class="bk-date-box">
              <div class="bk-month">2026/05</div>
              <div class="bk-day">04</div>
            </div>
            <div class="bk-content">
              <div class="bk-title">
                <span style="flex: 1; min-width: 0;">ğŸš„ æ¶å»ç¨‹é«˜éµ</span>
                <button class="booking-reminder-btn"
                  onclick="toggleBookingReminder('bk-train-go', 'é«˜éµå»ç¨‹æ¶ç¥¨', '2026-05-04T08:30:00+08:00', this)">ğŸ””
                  æé†’æˆ‘</button>
              </div>
              <div class="bk-platform">12306 (æå‰ 15 å¤©)</div>
              <div class="bk-desc">ã€æˆéƒ½æ± â” é»ƒé¾ä¹å¯¨ã€‘ã€‚æ”¾ç¥¨æ™‚é–“é€šå¸¸ç‚º 08:30 æˆ– 09:00ï¼Œå»ºè­°ææ—©å¹¾å¤©æŸ¥è©¢ç¢ºåˆ‡æ”¾ç¥¨æ™‚åˆ»ã€‚</div>
            </div>
          </div>

          <!-- 5/05 ä¹å¯¨ Day 1 -->
          <div class="booking-item">
            <div class="bk-date-box">
              <div class="bk-month">2026/05</div>
              <div class="bk-day">05</div>
            </div>
            <div class="bk-content">
              <div class="bk-title">
                <span style="flex: 1; min-width: 0;">ğŸï¸ æ¶ä¹å¯¨æºé–€ç¥¨</span>
                <button class="booking-reminder-btn"
                  onclick="toggleBookingReminder('bk-jiuzhai-d1', 'ä¹å¯¨æºD1é–€ç¥¨æ¶ç¥¨', '2026-05-05T08:00:00+08:00', this)">ğŸ””
                  æé†’æˆ‘</button>
              </div>
              <div class="bk-platform">é˜¿å£©æ—…éŠç¶² (æå‰ 14 å¤©)</div>
              <div class="bk-desc">è³¼è²·ä¹å¯¨æºã€Œç¬¬ä¸€å¤©ã€å…¨åƒ¹ç¥¨èˆ‡è§€å…‰è»Šç¥¨ã€‚</div>
            </div>
          </div>

          <!-- 5/06 ä¹å¯¨ Day 2 -->
          <div class="booking-item">
            <div class="bk-date-box">
              <div class="bk-month">2026/05</div>
              <div class="bk-day">06</div>
            </div>
            <div class="bk-content">
              <div class="bk-title">
                <span style="flex: 1; min-width: 0;">ğŸï¸ æ¶ä¹å¯¨æºé–€ç¥¨</span>
                <button class="booking-reminder-btn"
                  onclick="toggleBookingReminder('bk-jiuzhai-d2', 'ä¹å¯¨æºD2é–€ç¥¨æ¶ç¥¨', '2026-05-06T08:00:00+08:00', this)">ğŸ””
                  æé†’æˆ‘</button>
              </div>
              <div class="bk-platform">é˜¿å£©æ—…éŠç¶² (æå‰ 14 å¤©)</div>
              <div class="bk-desc">è³¼è²·ä¹å¯¨æºã€Œç¬¬äºŒå¤©ã€é–€ç¥¨ï¼ˆæ—ºå­£ç„¡äºŒæ¬¡é€²æºå„ªæƒ ï¼Œéœ€é‡æ–°è²·ç¥¨è»Šï¼‰ã€‚</div>
            </div>
          </div>

          <!-- 5/07 é«˜éµå›ç¨‹ -->
          <div class="booking-item">
            <div class="bk-date-box">
              <div class="bk-month">2026/05</div>
              <div class="bk-day">07</div>
            </div>
            <div class="bk-content">
              <div class="bk-title">
                <span style="flex: 1; min-width: 0;">ğŸš„ æ¶å›ç¨‹é«˜éµ</span>
                <button class="booking-reminder-btn"
                  onclick="toggleBookingReminder('bk-train-back', 'é«˜éµå›ç¨‹æ¶ç¥¨', '2026-05-07T08:30:00+08:00', this)">ğŸ””
                  æé†’æˆ‘</button>
              </div>
              <div class="bk-platform">12306 (æå‰ 15 å¤©)</div>
              <div class="bk-desc">ã€é»ƒé¾ä¹å¯¨ â” æˆéƒ½æ±ã€‘ã€‚</div>
            </div>
          </div>

          <!-- 5/08 éƒ½æ±Ÿå ° -->
          <div class="booking-item">
            <div class="bk-date-box">
              <div class="bk-month">2026/05</div>
              <div class="bk-day">08</div>
            </div>
            <div class="bk-content">
              <div class="bk-title">
                <span style="flex: 1; min-width: 0;">ğŸŒŠ æ¶éƒ½æ±Ÿå °é–€ç¥¨</span>
                <button class="booking-reminder-btn"
                  onclick="toggleBookingReminder('bk-dujiangyan', 'éƒ½æ±Ÿå °é–€ç¥¨æ¶ç¥¨', '2026-05-08T08:00:00+08:00', this)">ğŸ””
                  æé†’æˆ‘</button>
              </div>
              <div class="bk-platform">é’åŸå±±éƒ½æ±Ÿå ° (æå‰ 14 å¤©)</div>
              <div class="bk-desc">é€šå¸¸æå‰ 14 å¤©é–‹æ”¾é è¨‚ã€‚</div>
            </div>
          </div>

          <!-- 5/16 ç†Šè²“è°· -->
          <div class="booking-item">
            <div class="bk-date-box">
              <div class="bk-month">2026/05</div>
              <div class="bk-day">16</div>
            </div>
            <div class="bk-content">
              <div class="bk-title">
                <span style="flex: 1; min-width: 0;">ğŸ¼ æ¶ç†Šè²“è°·é–€ç¥¨</span>
                <button class="booking-reminder-btn"
                  onclick="toggleBookingReminder('bk-panda', 'ç†Šè²“è°·é–€ç¥¨æ¶ç¥¨', '2026-05-16T08:00:00+08:00', this)">ğŸ””
                  æé†’æˆ‘</button>
              </div>
              <div class="bk-platform">ç†Šè²“è°· (æå‰ 7 å¤©)</div>
              <div class="bk-desc">ç†Šè²“æ€•ç†±ï¼Œå¼·çƒˆå»ºè­°æ¶æ—©ä¸Šçš„æ™‚æ®µå…¥åœ’ã€‚</div>
            </div>
          </div>

          <!-- 5/19 ä¸‰æ˜Ÿå † (Boss!) -->
          <div class="booking-item">
            <div class="bk-date-box bk-danger">
              <div class="bk-month">05/19 æ™šä¸Š</div>
              <div class="bk-day">20:00</div>
            </div>
            <div class="bk-content bk-content-danger">
              <div class="bk-title">
                <span style="flex: 1; min-width: 0;">ğŸ”± æ¶ä¸‰æ˜Ÿå †é–€ç¥¨ <span class="bk-danger-tag">æ¥µé›£</span></span>
                <button class="booking-reminder-btn"
                  onclick="toggleBookingReminder('bk-sanxingdui', 'ä¸‰æ˜Ÿå †é–€ç¥¨æ¶ç¥¨', '2026-05-19T20:00:00+08:00', this)">ğŸ””
                  æé†’æˆ‘</button>
              </div>
              <div class="bk-platform" style="background:#fecaca; color:#b91c1c;">ä¸‰æ˜Ÿå †åšç‰©é¤¨ (æå‰ 5 å¤©)</div>
              <div class="bk-desc" style="color:#7f1d1d;"><strong>âš ï¸ é­”ç‹ç´šé›£åº¦ï¼š</strong>æ•´è¶Ÿæ—…ç¨‹æœ€é›£æ¶çš„ç¥¨ï¼æ¯å¤©æ™šä¸Š 20:00 æº–æ™‚é‡‹æ”¾ 5
                å¤©å¾Œçš„ç¥¨ï¼Œå¹¾åˆ†é˜å…§ç§’æ®ºã€‚
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== æ‰“åŒ…æ¸…å–® Modal ===== -->
  <div class="settings-overlay" id="packing-overlay" onclick="if(event.target===this) closePacking()">
    <div class="expense-panel">
      <div class="sp-header" style="margin-bottom:10px">
        <div class="sp-title"><i data-lucide="backpack"></i> å¿…å‚™æ‰“åŒ…æ¸…å–®</div>
        <button class="sp-close" onclick="closePacking()">âœ•</button>
      </div>

      <div class="packing-progress-bg">
        <div class="packing-progress-bar" id="packing-progress-bar"></div>
      </div>
      <div class="packing-progress-text" id="packing-progress-text">0 / 0 (0%)</div>

      <div class="packing-content" id="packing-content">
        <!-- åˆ†é¡åˆ—è¡¨ç”± JS ç¹ªè£½ -->
      </div>
    </div>
  </div>

  <!-- ===== è¨˜å¸³èˆ‡åŒ¯ç‡é¢æ¿ Modal ===== -->
  <div class="settings-overlay" id="expense-overlay" onclick="if(event.target===this) closeExpense()">
    <div class="expense-panel">
      <div class="sp-header" style="margin-bottom:0">
        <div class="sp-title"><i data-lucide="calculator"></i> åŒ¯ç‡èˆ‡è¨˜å¸³</div>
        <button class="sp-close" onclick="closeExpense()">âœ•</button>
      </div>

      <!-- åŒ¯ç‡å¡ç‰‡ -->
      <div class="ep-rate-card">
        <div>
          <div class="ep-rate-title">ä»Šæ—¥åƒè€ƒåŒ¯ç‡ (RMB/TWD)</div>
          <div class="ep-rate-value" id="current-rate-display">è¼‰å…¥ä¸­...</div>
        </div>
        <button class="ep-rate-refresh" onclick="fetchExchangeRate(true)">ğŸ”„</button>
      </div>

      <!-- ç¸½èŠ±è²»å¡ç‰‡ -->
      <div class="ep-total-card">
        <div class="ep-total-title">æœ¬è¶Ÿæ—…ç¨‹ç¸½èŠ±è²»</div>
        <div class="ep-total-twd" id="ep-total-twd">NT$ 0</div>
        <div class="ep-total-rmb" id="ep-total-rmb">Â¥ 0</div>
      </div>

      <!-- æ–°å¢è¨˜å¸³è¡¨å–® -->
      <div style="display:flex; flex-direction:column; gap:10px;">
        <div class="ep-input-group">
          <div class="ep-input-wrap">
            <span>Â¥</span>
            <input type="number" id="ep-input-rmb" class="ep-input" placeholder="äººæ°‘å¹£" oninput="convertCurrency('rmb')">
          </div>
          <div style="display:flex;align-items:center;color:var(--text-sub);font-weight:bold;">=</div>
          <div class="ep-input-wrap">
            <span>NT$</span>
            <input type="number" id="ep-input-twd" class="ep-input" placeholder="å°å¹£" oninput="convertCurrency('twd')">
          </div>
        </div>
        <input type="text" id="ep-input-desc" class="ep-input-desc" placeholder="é …ç›®èªªæ˜ (ä¾‹å¦‚ï¼šåˆé¤ä¸²ä¸²é¦™)">
        <button class="ep-btn-submit" onclick="addExpense()">âœï¸ è¨˜ä¸Šä¸€ç­†</button>
      </div>

      <!-- è¨˜å¸³æ˜ç´°åˆ—è¡¨ -->
      <div>
        <div class="sp-group-title" style="margin-bottom:4px; display:flex; justify-content:space-between;">
          <span>ğŸ“‹ æ”¯å‡ºæ˜ç´°</span>
          <span style="cursor:pointer; color:#EF4444; text-transform:none; font-size:11px;"
            onclick="clearExpenses()">æ¸…ç©º</span>
        </div>
        <div class="expense-list" id="expense-list-container">
          <!-- æ˜ç´°é …ç›®å°‡ç”± JS ç”¢ç”Ÿ -->
        </div>
      </div>
    </div>
  </div>

  <!-- ===== è¨­å®šé¢æ¿ Modal ===== -->
  <div class="settings-overlay" id="settings-overlay" onclick="if (event.target === this) closeSettings();">
    <div class="settings-panel">
      <div class="sp-header">
        <div class="sp-title"><i data-lucide="settings"></i> è¨­å®š</div>
        <button class="sp-close" onclick="closeSettings()">âœ•</button>
      </div>

      <!-- å¤–è§€è¨­å®š -->
      <div class="sp-group">
        <div class="sp-group-title">ğŸ¨ å¤–è§€</div>
        <div class="sp-row">
          <div class="sp-row-label">ğŸŒ™ æ·±è‰²æ¨¡å¼</div>
          <button class="toggle-switch" id="toggle-dark" onclick="toggleDarkMode()"></button>
        </div>
        <div class="sp-row">
          <div class="sp-row-label">ğŸ”¤ å­—å‹å¤§å°</div>
          <div class="font-size-selector">
            <button id="fs-small" onclick="setFontSize('small')">å°</button>
            <button id="fs-medium" class="active" onclick="setFontSize('medium')">
              ä¸­
            </button>
            <button id="fs-large" onclick="setFontSize('large')">å¤§</button>
          </div>
        </div>
      </div>

      <!-- è³‡æ–™ç®¡ç† -->
      <div class="sp-group">
        <div class="sp-group-title">ğŸ—ƒï¸ è³‡æ–™ç®¡ç†</div>
        <button class="sp-action-btn" onclick="refreshWeather()">
          ğŸ”„ é‡æ–°è¼‰å…¥å¤©æ°£è³‡æ–™
        </button>
        <button class="sp-action-btn danger" onclick="clearAllCache()">
          ğŸ—‘ï¸ æ¸…é™¤æ‰€æœ‰å¿«å–è³‡æ–™
        </button>
      </div>

      <!-- é—œæ–¼ -->
      <div class="sp-group">
        <div class="sp-group-title">â„¹ï¸ é—œæ–¼</div>
        <div class="sp-row">
          <div class="sp-row-label">âœˆï¸ èˆªç­è¿½è¹¤</div>
          <span style="font-size: 11px; color: var(--text-sub)">OpenSky Network</span>
        </div>
        <div class="sp-row">
          <div class="sp-row-label">ğŸ“‹ èˆªç­è©³æƒ…</div>
          <span style="font-size: 11px; color: var(--text-sub)">Aviationstack</span>
        </div>
        <div class="sp-row">
          <div class="sp-row-label">ğŸŒ¤ï¸ å¤©æ°£è³‡æ–™</div>
          <span style="font-size: 11px; color: var(--text-sub)">Open-Meteo</span>
        </div>
        <div class="sp-row">
          <div class="sp-row-label">ğŸ—ºï¸ åœ°åœ–æœå‹™</div>
          <span style="font-size: 11px; color: var(--text-sub)">é«˜å¾·åœ°åœ– AMap</span>
        </div>
      </div>

      <div class="sp-version">æˆéƒ½æ·±åº¦æ—…éŠ 2026 Â· v1.0</div>
    </div>
  </div>

  <!-- ===== è¨˜å¸³èˆ‡åŒ¯ç‡é¢æ¿ Modal ===== -->
  <div class="settings-overlay" id="expense-overlay" onclick="if(event.target===this)closeExpense()">
    <div class="expense-panel">
      <div class="sp-header" style="margin-bottom:0">
        <div class="sp-title"><i data-lucide="calculator"></i> åŒ¯ç‡èˆ‡è¨˜å¸³</div>
        <button class="sp-close" onclick="closeExpense()">âœ•</button>
      </div>

      <!-- åŒ¯ç‡å¡ç‰‡ -->
      <div class="ep-rate-card">
        <div>
          <div class="ep-rate-title">ä»Šæ—¥åƒè€ƒåŒ¯ç‡ (RMB/TWD)</div>
          <div class="ep-rate-value" id="current-rate-display">è¼‰å…¥ä¸­...</div>
        </div>
        <button class="ep-rate-refresh" onclick="fetchExchangeRate(true)">ğŸ”„</button>
      </div>

      <!-- ç¸½èŠ±è²»å¡ç‰‡ -->
      <div class="ep-total-card">
        <div class="ep-total-title">æœ¬è¶Ÿæ—…ç¨‹ç¸½èŠ±è²»</div>
        <div class="ep-total-twd" id="ep-total-twd">NT$ 0</div>
        <div class="ep-total-rmb" id="ep-total-rmb">Â¥ 0</div>
      </div>

      <!-- æ–°å¢è¨˜å¸³è¡¨å–® -->
      <div style="display:flex; flex-direction:column; gap:10px;">
        <div class="ep-input-group">
          <div class="ep-input-wrap">
            <span>Â¥</span>
            <input type="number" id="ep-input-rmb" class="ep-input" placeholder="äººæ°‘å¹£" oninput="convertCurrency('rmb')">
          </div>
          <div style="display:flex;align-items:center;color:var(--text-sub);font-weight:bold;">=</div>
          <div class="ep-input-wrap">
            <span>NT$</span>
            <input type="number" id="ep-input-twd" class="ep-input" placeholder="å°å¹£" oninput="convertCurrency('twd')">
          </div>
        </div>
        <input type="text" id="ep-input-desc" class="ep-input-desc" placeholder="é …ç›®èªªæ˜ (ä¾‹å¦‚ï¼šåˆé¤ä¸²ä¸²é¦™)">
        <button class="ep-btn-submit" onclick="addExpense()">âœï¸ è¨˜ä¸Šä¸€ç­†</button>
      </div>

      <!-- è¨˜å¸³æ˜ç´°åˆ—è¡¨ -->
      <div>
        <div class="sp-group-title" style="margin-bottom:4px; display:flex; justify-content:space-between;">
          <span>ğŸ“‹ æ”¯å‡ºæ˜ç´°</span>
          <span style="cursor:pointer; color:#EF4444; text-transform:none; font-size:11px;"
            onclick="clearExpenses()">æ¸…ç©º</span>
        </div>
        <div class="expense-list" id="expense-list-container">
          <!-- æ˜ç´°é …ç›®å°‡ç”± JS ç”¢ç”Ÿ -->
        </div>
      </div>

    </div>
  </div>

  <!-- ===== é«˜å¾·åœ°åœ–åˆå§‹åŒ–è…³æœ¬ ===== -->
  <script>
    /**
     * åˆå§‹åŒ–ç¸½è¦½åœ°åœ–
     * é¡¯ç¤ºè¡Œç¨‹æ‰€æœ‰æ™¯é»çš„æ¨™è¨˜ï¼Œä¸åŒå¤©ç”¨ä¸åŒé¡è‰²å€åˆ†
     * 9å¤©è¡Œç¨‹æ¶µè“‹ï¼šæˆéƒ½å¸‚å€ â†’ é»ƒé¾æºª â†’ ä¹å¯¨æº â†’ é»ƒé¾ â†’ æˆéƒ½
     */

    // å„å¤©ä»£è¡¨æ€§æ™¯é»ï¼ˆåº§æ¨™ç‚º GCJ-02 é«˜å¾·åæ¨™ç³»ï¼‰
    const allSpots = [
      // Day 1 - ç¥ç€è‰²ï¼ˆæŠµé”æˆéƒ½å¸‚å€ï¼‰
      {
        day: 1,
        name: "æ˜¥ç†™è·¯",
        lat: 30.6574,
        lng: 104.081,
        color: "#F59E0B",
      },
      {
        day: 1,
        name: "IFSæˆéƒ½",
        lat: 30.6558,
        lng: 104.0793,
        color: "#F59E0B",
      },
      {
        day: 1,
        name: "å¤ªå¤é‡Œ",
        lat: 30.6547,
        lng: 104.082,
        color: "#F59E0B",
      },

      // Day 2 - ç¿ ç¶ è‰²ï¼ˆé»ƒé¾æºªå¤é®ï¼‰
      {
        day: 2,
        name: "é»ƒé¾æºªå¤é®",
        lat: 30.3184,
        lng: 103.9711,
        color: "#10B981",
      },

      // Day 3 - è—è‰²ï¼ˆç§»å‹•è‡³ä¹å¯¨æºï¼‰
      {
        day: 3,
        name: "ä¹å¯¨æºÂ·å½­è±æ‘",
        lat: 33.16,
        lng: 103.85,
        color: "#3B82F6",
      },

      // Day 4 - é’è‰²ï¼ˆä¹å¯¨æºæ™¯å€ï¼‰
      {
        day: 4,
        name: "ä¹å¯¨æºæ™¯å€",
        lat: 33.26,
        lng: 103.92,
        color: "#06B6D4",
      },

      // Day 5 - ç´«è‰²ï¼ˆå·ä¸»å¯ºï¼‰
      { day: 5, name: "å·ä¸»å¯º", lat: 32.75, lng: 103.57, color: "#8B5CF6" },

      // Day 6 - ç«ç´…ï¼ˆé»ƒé¾æ™¯å€ï¼‰
      {
        day: 6,
        name: "é»ƒé¾æ™¯å€",
        lat: 32.7284,
        lng: 103.8312,
        color: "#EC4899",
      },

      // Day 7 - æ©™è‰²ï¼ˆæˆéƒ½å¸‚å€æ™¯é»ï¼‰
      {
        day: 7,
        name: "ç†Šè²“ç¹è‚²åŸºåœ°",
        lat: 30.7322,
        lng: 104.1355,
        color: "#F97316",
      },
      {
        day: 7,
        name: "å¯¬çª„å··å­",
        lat: 30.6726,
        lng: 104.0536,
        color: "#F97316",
      },
      {
        day: 7,
        name: "æœç”«è‰å ‚",
        lat: 30.6655,
        lng: 104.0359,
        color: "#F97316",
      },
      {
        day: 7,
        name: "æ­¦ä¾¯ç¥ ",
        lat: 30.6432,
        lng: 104.0474,
        color: "#F97316",
      },

      // Day 8 - é’ç¶ ï¼ˆè³¼ç‰©+æ©Ÿå ´ï¼‰
      {
        day: 8,
        name: "æ˜¥ç†™è·¯è³¼ç‰©",
        lat: 30.6574,
        lng: 104.081,
        color: "#14B8A6",
      },
      {
        day: 8,
        name: "å¤©åºœåœ‹éš›æ©Ÿå ´",
        lat: 30.3135,
        lng: 104.4451,
        color: "#14B8A6",
      },

      // Day 9 - ç´…è‰²ï¼ˆè¿”ç¨‹ï¼‰
      {
        day: 9,
        name: "å¤©åºœæ©Ÿå ´å‡ºç™¼",
        lat: 30.3135,
        lng: 104.4451,
        color: "#EF4444",
        type: "attraction"
      },

      // ç¾é£Ÿ
      { type: 'food', day: '-', name: "é™¶å¾·æ–¯æˆéƒ½å¸‚äº•ç«é‹", lat: 30.655, lng: 104.08, color: "#EF4444" },
      { type: 'food', day: '-', name: "æ´å­å£å¼µè€äºŒæ¶¼ç²‰", lat: 30.66, lng: 104.07, color: "#EF4444" },

      // è³¼ç‰©
      { type: 'shopping', day: '-', name: "IFS å¤ªå¤é‡Œå•†åœˆ", lat: 30.6558, lng: 104.0793, color: "#8B5CF6" },
      { type: 'shopping', day: '-', name: "æ˜¥ç†™è·¯æ­¥è¡Œè¡—", lat: 30.6574, lng: 104.081, color: "#8B5CF6" },
    ];

    // å…¨åŸŸåœ°åœ–èˆ‡ç•¶å‰é£›æ©Ÿæ¨™è¨˜
    let map = null;
    let flightMarker = null;
    let allMarkers = []; // å„²å­˜æ‰€æœ‰æ¨™è¨˜ä»¥ä¾¿ç¯©é¸

    // ç­‰ AMap SDK å®Œå…¨è¼‰å…¥å¾Œæ‰åˆå§‹åŒ–
    window.onload = function () {
      try {
        // å»ºç«‹åœ°åœ–ï¼ˆè¼ƒå¤§è¦–è§’ä»¥æ¶µè“‹æˆéƒ½åˆ°ä¹å¯¨æºï¼‰
        map = new AMap.Map("amap-overview", {
          zoom: 7,
          center: [104.0665, 31.5], // å››å·ä¸­éƒ¨ååŒ—
          mapStyle: "amap://styles/whitesmoke",
          resizeEnable: true,
        });

        // åœ¨åœ°åœ–ä¸ŠåŠ å…¥æ‰€æœ‰æ™¯é»æ¨™è¨˜
        allSpots.forEach(function (spot) {
          var marker = new AMap.CircleMarker({
            center: new AMap.LngLat(spot.lng, spot.lat),
            radius: 7,
            strokeColor: "#fff",
            strokeWeight: 2,
            fillColor: spot.color,
            fillOpacity: 0.95,
            zIndex: 10,
            cursor: "pointer",
          });
          marker.spotType = spot.type || 'attraction'; // è¨­å®šç¯©é¸é¡åˆ¥
          marker.setMap(map);
          allMarkers.push(marker);

          // é»æ“Šæ™¯é»é¡¯ç¤ºè³‡è¨Šå½ˆçª—
          marker.on("click", function () {
            var infoWindow = new AMap.InfoWindow({
              content: `
                  <div style="padding:8px 12px;font-family:'Plus Jakarta Sans',sans-serif;">
                    <div style="font-weight:700;font-size:14px;color:#1E3A5F;margin-bottom:2px;">
                      ${spot.name}
                    </div>
                    <div style="font-size:12px;color:#6B7280;">Day ${spot.day}ãƒ»ç¬¬${spot.day}å¤©è¡Œç¨‹</div>
                  </div>
                `,
              offset: new AMap.Pixel(0, -10),
            });
            infoWindow.open(map, marker.getCenter());
          });
        });

        // åœ–ä¾‹ï¼ˆå„å¤©é¡è‰²èªªæ˜ï¼‰
        var legend = document.createElement("div");
        legend.style.cssText =
          "position:absolute;bottom:10px;left:10px;background:rgba(255,255,255,0.92);border-radius:8px;padding:6px 10px;font-size:9px;font-family:sans-serif;z-index:50;box-shadow:0 2px 8px rgba(0,0,0,0.15);line-height:1.6;";
        legend.innerHTML = [
          '<span style="color:#F59E0B;">â— </span>D1',
          '<span style="color:#10B981;">â— </span>D2',
          '<span style="color:#3B82F6;">â— </span>D3',
          '<span style="color:#06B6D4;">â— </span>D4',
          '<span style="color:#8B5CF6;">â— </span>D5',
          '<span style="color:#EC4899;">â— </span>D6',
          '<span style="color:#F97316;">â— </span>D7',
          '<span style="color:#14B8A6;">â— </span>D8',
          '<span style="color:#EF4444;">â— </span>D9',
        ].join("  ");
        document.getElementById("amap-overview").appendChild(legend);

        // å®šç¾©ç¯©é¸é‚è¼¯
        window.filterMap = function (type, btnEl) {
          // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
          document.querySelectorAll('.map-filter-btn').forEach(b => b.classList.remove('active'));
          btnEl.classList.add('active');

          // é¡¯ç¤ºæˆ–éš±è— Marker
          allMarkers.forEach(m => {
            if (type === 'all') {
              m.show();
            } else if (m.spotType === type) {
              m.show();
            } else {
              m.hide();
            }
          });
        };
      } catch (e) {
        document.getElementById("amap-overview").innerHTML =
          '<div style="height:220px;display:flex;align-items:center;justify-content:center;background:#F3F4F6;border-radius:16px;color:#6B7280;font-size:14px;">åœ°åœ–è¼‰å…¥ä¸­...</div>';
      }
    };

    // ===== å³æ™‚èˆªç­è¿½è¹¤é‚è¼¯ =====
    // ç”±æ–¼è¡Œç¨‹æ˜¯åœ¨ 2026 å¹´ï¼ŒéçœŸå¯¦é£›è¡Œæ™‚é–“æœƒæ‰¾ä¸åˆ°è©²èˆªç­ã€‚
    // fallback æ©Ÿåˆ¶ï¼šå¦‚æœæ‰¾ä¸åˆ°ç‰¹å®šèˆªç­ï¼Œå°±æŠ“å–è©²ç©ºåŸŸå…§ä»»æ„ä¸€æ¶æ­£åœ¨é£›è¡Œçš„é£›æ©Ÿä¾†é€²è¡Œã€Œè¦–è¦ºå±•ç¤ºã€ã€‚
    async function trackFlight(callsign, lamin, lomin, lamax, lomax) {
      if (!map) return;

      const btnEl = document.getElementById(`track-btn-${callsign}`);
      if (btnEl) {
        btnEl.disabled = true;
        btnEl.innerHTML = "ğŸ”„ æœå°‹ä¸­...";
      }

      try {
        // å‘ OpenSky API è«‹æ±‚è©² Bounding Box å…§çš„èˆªç­
        const response = await fetch(
          `https://opensky-network.org/api/states/all?lamin=${lamin}&lomin=${lomin}&lamax=${lamax}&lomax=${lomax}`,
        );
        const data = await response.json();

        if (!data || !data.states || data.states.length === 0) {
          alert("æ­¤ç©ºåŸŸç›®å‰æŸ¥ç„¡ä»»ä½•èˆªç­å‹•æ…‹ï¼");
          resetTrackButton(btnEl);
          return;
        }

        // å°‹æ‰¾æŒ‡å®šçš„èˆªç­ (callsign æœ‰æ™‚æœƒæœ‰ç©ºç™½å¾Œç¶´)
        let targetFlight = data.states.find(
          (flight) => flight[1] && flight[1].trim() === callsign,
        );

        let isDemo = false;
        // è‹¥æ‰¾ä¸åˆ°æŒ‡å®šçš„èˆªç­ï¼ˆå› ç‚ºé‚„æ²’é£›æˆ–é£›å®Œäº†ï¼‰ï¼Œé€²å…¥ Demo æ¨¡å¼ï¼šæŠ“å–ç¬¬ä¸€æ¶åœ¨ç©ºä¸­çš„é£›æ©Ÿ
        if (!targetFlight) {
          targetFlight = data.states.find((flight) => flight[5] && flight[6]); // ç¢ºä¿æœ‰ç¶“ç·¯åº¦
          isDemo = true;
          if (!targetFlight) {
            alert("æ­¤ç©ºåŸŸç›®å‰ç„¡å¯è¿½è¹¤çš„èˆªç­ï¼");
            resetTrackButton(btnEl);
            return;
          }
        }

        const lng = targetFlight[5];
        const lat = targetFlight[6];
        const track = targetFlight[10] || 0; // èˆªå‘è§’
        const velocity = targetFlight[9] || 0; // m/s
        const altitude = targetFlight[13] || 0; // å¹¾ä½•é«˜åº¦(m)
        const actualCallsign = targetFlight[1]
          ? targetFlight[1].trim()
          : "UNKNOWN";

        // è‹¥å·²ç¶“æœ‰æ¨™è¨˜ï¼Œå…ˆç§»é™¤
        if (flightMarker) {
          map.remove(flightMarker);
        }

        // SVG é£›æ©Ÿåœ–ç¤º
        const planeSvg = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M21 16V14L13 9V3.5C13 2.67 12.33 2 11.5 2C10.67 2 10 2.67 10 3.5V9L2 14V16L10 13.5V19L8 20.5V22L11.5 21L15 22V20.5L13 19V13.5L21 16Z" fill="#2563EB" stroke="#FFFFFF" stroke-width="1.5" stroke-linejoin="round"/>
          </svg>`;

        // å»ºç«‹é£›æ©Ÿæ¨™è¨˜
        flightMarker = new AMap.Marker({
          map: map,
          position: [lng, lat],
          content: `<div style="transform: rotate(${track}deg); width: 24px; height: 24px; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));">${planeSvg}</div>`,
          offset: new AMap.Pixel(-12, -12),
          zIndex: 100,
        });

        // å¦‚æœæ˜¯å±•ç¤ºæ¨¡å¼ï¼Œçµ¦å‡ºæç¤º
        let contentHtml = `
            <div style="padding:10px 14px;font-family:'Plus Jakarta Sans',sans-serif;min-width:160px;">
              <div style="font-weight:800;font-size:15px;color:#1E3A5F;margin-bottom:6px;border-bottom:2px solid #3B82F6;display:inline-block;padding-bottom:2px;">
                âœˆï¸ èˆªç­ ${actualCallsign}
              </div>
              <div style="font-size:12px;color:#4B5563;margin-bottom:4px;display:flex;justify-content:space-between;">
                <span>é«˜åº¦:</span> <span style="font-weight:600;color:#1E3A5F;">${Math.round(altitude)} m</span>
              </div>
              <div style="font-size:12px;color:#4B5563;margin-bottom:4px;display:flex;justify-content:space-between;">
                <span>é€Ÿåº¦:</span> <span style="font-weight:600;color:#1E3A5F;">${Math.round(velocity * 3.6)} km/h</span>
              </div>
              ${isDemo ? '<div style="margin-top:8px;font-size:10px;color:#D97706;background:#FEF3C7;padding:4px 6px;border-radius:4px;text-align:center;">ç›®å‰éè¡¨å®šé£›è¡Œæ™‚é–“<br>é¡¯ç¤ºç©ºåŸŸå…§å…¶ä»–èˆªç­ä½œå±•ç¤º</div>' : ""}
            </div>
          `;

        var infoWindow = new AMap.InfoWindow({
          content: contentHtml,
          offset: new AMap.Pixel(0, -15),
        });

        // è‡ªå‹•å¹³ç§»åœ°åœ–ä¸¦æ‰“é–‹è³‡è¨Šçª—
        map.setZoomAndCenter(6, [lng, lat], false, 1000);
        setTimeout(() => {
          infoWindow.open(map, flightMarker.getPosition());
          // æ»¾å‹•ç•«é¢è‡³åœ°åœ–å€å¡Š
          document
            .getElementById("amap-overview")
            .scrollIntoView({ behavior: "smooth", block: "center" });
        }, 600);
      } catch (err) {
        console.error("OpenSky API è«‹æ±‚å¤±æ•—", err);
        alert("ç²å–èˆªç­è³‡æ–™å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ï¼");
      } finally {
        resetTrackButton(btnEl);
      }
    }

    function resetTrackButton(btnEl) {
      if (btnEl) {
        btnEl.disabled = false;
        btnEl.innerHTML = "âœˆï¸ è¿½è¹¤èˆªç­";
      }
    }

    // ===== å¿…å‚™æ‰“åŒ…æ¸…å–®é‚è¼¯ =====
    const packingData = [
      {
        category: "è­‰ä»¶èˆ‡é‡‘éŒ¢ ğŸ†”",
        items: ["å°èƒè­‰ (ç¢ºèªæ•ˆæœŸ)", "è­·ç…§ (å‚™ç”¨)", "èº«åˆ†è­‰ (å‚™ç”¨)", "äººæ°‘å¹£ç¾é‡‘", "ä¿¡ç”¨å¡/é‡‘èå¡ (ç¶å®šå¾®ä¿¡/æ”¯ä»˜å¯¶)", "å¤§é ­ç…§å‚™ç”¨"]
      },
      {
        category: "é›»å­ç”¢å“ ğŸ“±",
        items: ["æ‰‹æ©Ÿ", "è¡Œå‹•é›»æº (20000mAhä»¥å…§)", "å……é›»ç·š (å¤šå‚™å¹¾æ¢)", "è¬åœ‹è½‰æ¥é ­ (ä¸­åœ‹220V)", "ç›¸æ©Ÿ/è¨˜æ†¶å¡/é›»æ± ", "è€³æ©Ÿ"]
      },
      {
        category: "è¡£ç‰©èˆ‡ç©¿æ­ ğŸ§¥",
        items: ["æ›æ´—è¡£ç‰© (æ´‹è”¥å¼ç©¿æ­)", "ä¿æš–å¤–å¥— (ä¹å¯¨æº/é»ƒé¾æ—©æ™šå†·)", "å¥½ç©¿èµ°çš„é‹å‹•é‹", "è¼•ä¾¿é›¨è¡£/é›¨å‚˜", "å¸½å­/å¢¨é¡", "ç¡è¡£/å…§è¡£è¤²"]
      },
      {
        category: "å€‹äººè—¥å“èˆ‡ä¿é¤Š ğŸ’Š",
        items: ["é«˜å±±ç—‡è—¥ç‰© (ç´…æ™¯å¤©/å¨è€Œé‹¼)", "æšˆè»Šè—¥ (å±±è·¯å¤š)", "è…¸èƒƒè—¥/æ„Ÿå†’è—¥/æ­¢ç—›è—¥", "é˜²æ›¬ä¹³/è­·å”‡è†", "ä¿æ¿•ä¹³æ¶² (é«˜åŸä¹¾ç‡¥)", "å€‹äººæ…£ç”¨ä¿é¤Šå“"]
      },
      {
        category: "å…¶ä»–å¯¦ç”¨å°ç‰© ğŸ’",
        items: ["éš¨èº«å°åŒ…", "ä¿æº«ç“¶", "ä¹¾æ´—æ‰‹/æ¿•ç´™å·¾", "è¼•ä¾¿ç’°ä¿è¢‹", "é¢ç´™", "é ¸æ• (é•·é€”è»Šç”¨)"]
      }
    ];

    let packingState = JSON.parse(localStorage.getItem('packing_list') || '{}');

    function renderPackingList() {
      const container = document.getElementById('packing-content');
      let html = '';
      let totalItems = 0;
      let checkedItems = 0;

      packingData.forEach((cat, catIdx) => {
        let itemsHtml = '';
        cat.items.forEach((item, itemIdx) => {
          totalItems++;
          const key = `cat${catIdx}_item${itemIdx}`;
          const isChecked = packingState[key];
          if (isChecked) checkedItems++;

          itemsHtml += `
            <div class="packing-item ${isChecked ? 'checked' : ''}" onclick="togglePackingItem('${key}')">
              <div class="packing-checkbox ${isChecked ? 'checked' : ''}"></div>
              <div class="packing-label">${item}</div>
            </div>
          `;
        });

        html += `
          <div class="packing-category">
            <div class="packing-category-title">${cat.category}</div>
            <div class="packing-items">${itemsHtml}</div>
          </div>
        `;
      });

      container.innerHTML = html;
      updatePackingProgress(checkedItems, totalItems);
    }

    function togglePackingItem(key) {
      packingState[key] = !packingState[key];
      localStorage.setItem('packing_list', JSON.stringify(packingState));
      renderPackingList(); // é‡æ–°ç¹ªè£½ä»¥æ›´æ–°ç‹€æ…‹
    }

    function openPacking() {
      document.getElementById('packing-overlay').classList.add('open');
      renderPackingList();
    }

    function closePacking() {
      document.getElementById('packing-overlay').classList.remove('open');
    }

    function updatePackingProgress(checkedItems, totalItems) {
      const progressBar = document.getElementById('packing-progress-bar');
      const progressText = document.getElementById('packing-progress-text');

      const percentage = totalItems === 0 ? 0 : Math.round((checkedItems / totalItems) * 100);
      progressBar.style.width = `${percentage}%`;
      progressText.innerText = `${checkedItems} / ${totalItems} (${percentage}%)`;
    }

    // åˆå§‹åŒ–é€²åº¦æ¢ï¼Œä¸éœ€è¦å±•é–‹ä¹Ÿèƒ½çœ‹åˆ°é€²åº¦
    function initPackingProgress() {
      let totalItems = 0;
      let checkedItems = 0;
      packingData.forEach((cat, catIdx) => {
        cat.items.forEach((item, itemIdx) => {
          totalItems++;
          if (packingState[`cat${catIdx}_item${itemIdx}`]) checkedItems++;
        });
      });
      updatePackingProgress(checkedItems, totalItems);
    }

    // ç•¶ç¶²é è¼‰å…¥æ™‚åˆå§‹åŒ–
    window.addEventListener('DOMContentLoaded', initPackingProgress);

    // ===== æ¶ç¥¨æ—¥æ›†é‚è¼¯ =====
    function openBooking() {
      document.getElementById('booking-overlay').classList.add('open');
      renderBooking(); // refresh initial state if needed
    }

    function closeBooking() {
      document.getElementById('booking-overlay').classList.remove('open');
    }

    let bookingReminders = JSON.parse(localStorage.getItem('booking_reminders') || '{}');

    function renderBooking() {
      // Loop over all buttons and update their UI
      document.querySelectorAll('.booking-reminder-btn').forEach(btn => {
        const onclickAttr = btn.getAttribute('onclick');
        if (!onclickAttr) return;
        const match = onclickAttr.match(/'([^']+)'/);
        if (!match) return;

        const id = match[1]; // Extract the ID
        if (bookingReminders[id]) {
          btn.classList.add('active');
          btn.innerHTML = 'âœ… å·²è¨­æé†’';
        } else {
          btn.classList.remove('active');
          btn.innerHTML = 'ğŸ”” æé†’æˆ‘';
        }
      });
    }

    function toggleBookingReminder(id, title, dateTime, btnElement) {
      if (bookingReminders[id]) {
        if (confirm("è¦å–æ¶ˆæ­¤æé†’ç´€éŒ„å—ï¼Ÿ")) {
          bookingReminders[id] = false;
          localStorage.setItem('booking_reminders', JSON.stringify(bookingReminders));
          btnElement.classList.remove('active');
          btnElement.innerHTML = 'ğŸ”” æé†’æˆ‘';
        }
      } else {
        if (confirm("æ˜¯å¦ä¸‹è¼‰æ—¥æ›†æª”æ¡ˆ (.ics) åŠ å…¥æ‰‹æ©Ÿè¡Œäº‹æ›†ä¸­ï¼Ÿ\\nåŠ å…¥å¾Œä¸æ€•å¿˜è¨˜æ¶ç¥¨ï¼")) {
          downloadICS(id, title, dateTime);
        }
        bookingReminders[id] = true;
        localStorage.setItem('booking_reminders', JSON.stringify(bookingReminders));
        btnElement.classList.add('active');
        btnElement.innerHTML = 'âœ… å·²è¨­æé†’';
      }
    }

    function downloadICS(id, title, dateTime) {
      const dt = new Date(dateTime);
      const startStr = dt.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
      const dtEnd = new Date(dt.getTime() + 60 * 60 * 1000); // 1hr duration
      const endStr = dtEnd.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';

      const icsData = [
        "BEGIN:VCALENDAR",
        "VERSION:2.0",
        "PRODID:-//Chengdu Trip 2026//Booking Reminder//TW",
        "CALSCALE:GREGORIAN",
        "BEGIN:VEVENT",
        "SUMMARY:" + title,
        "DTSTART:" + startStr,
        "DTEND:" + endStr,
        "DESCRIPTION:è«‹æº–å‚™å¥½å°èƒè­‰ã€12306 æˆ–å¾®ä¿¡å°ç¨‹åºé–‹å§‹æ¶ç¥¨ï¼",
        "BEGIN:VALARM",
        "TRIGGER:-PT10M",
        "DESCRIPTION:Reminder",
        "ACTION:DISPLAY",
        "END:VALARM",
        "END:VEVENT",
        "END:VCALENDAR"
      ].join('\\r\\n');

      const blob = new Blob([icsData], { type: 'text/calendar;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = id + ".ics";
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
    }

    // ç•¶ç¶²é è¼‰å…¥æ™‚åˆå§‹åŒ– booking
    window.addEventListener('DOMContentLoaded', renderBooking);

    // ===== è¨˜å¸³èˆ‡åŒ¯ç‡é¢æ¿é‚è¼¯ =====
    let currentRate = 4.45; // é è¨­åŒ¯ç‡ (1 RMB = 4.45 TWD)
    let expenses = JSON.parse(localStorage.getItem('expense_records') || '[]');

    function openExpense() {
      document.getElementById("expense-overlay").classList.add("open");
      fetchExchangeRate(false);
      renderExpenses();
    }

    function closeExpense() {
      document.getElementById("expense-overlay").classList.remove("open");
    }

    async function fetchExchangeRate(forceRefresh = false) {
      const displayEl = document.getElementById('current-rate-display');

      const cachedTime = localStorage.getItem('exchange_rate_time');
      const cachedRate = localStorage.getItem('exchange_rate');

      // å¿«å– 24 å°æ™‚æœ‰æ•ˆ
      if (!forceRefresh && cachedRate && cachedTime && (Date.now() - parseInt(cachedTime) < 24 * 60 * 60 * 1000)) {
        currentRate = parseFloat(cachedRate);
        displayEl.innerText = `1 RMB = ${currentRate.toFixed(3)} TWD`;
        return;
      }

      displayEl.innerText = "æ›´æ–°ä¸­...";
      try {
        const res = await fetch('https://api.exchangerate-api.com/v4/latest/CNY');
        const data = await res.json();
        if (data && data.rates && data.rates.TWD) {
          currentRate = data.rates.TWD;
          localStorage.setItem('exchange_rate', currentRate.toString());
          localStorage.setItem('exchange_rate_time', Date.now().toString());
          displayEl.innerText = `1 RMB = ${currentRate.toFixed(3)} TWD`;
        }
      } catch (err) {
        console.error("åŒ¯ç‡ API å¤±æ•—", err);
        displayEl.innerText = `1 RMB â‰ˆ ${currentRate.toFixed(3)} TWD(é›¢ç·š)`;
      }
    }

    function convertCurrency(source) {
      const rmbInput = document.getElementById('ep-input-rmb');
      const twdInput = document.getElementById('ep-input-twd');

      if (source === 'rmb') {
        const val = parseFloat(rmbInput.value);
        if (!isNaN(val)) twdInput.value = Math.round(val * currentRate);
        else twdInput.value = '';
      } else {
        const val = parseFloat(twdInput.value);
        if (!isNaN(val)) rmbInput.value = (val / currentRate).toFixed(2);
        else rmbInput.value = '';
      }
    }

    function addExpense() {
      const rmbInput = document.getElementById('ep-input-rmb');
      const twdInput = document.getElementById('ep-input-twd');
      const descInput = document.getElementById('ep-input-desc');

      const rmbVal = parseFloat(rmbInput.value);
      const twdVal = parseFloat(twdInput.value);
      const desc = descInput.value.trim() || 'æœªå‘½åæ”¯å‡º';

      if (isNaN(rmbVal) || isNaN(twdVal) || rmbVal <= 0) {
        alert("è«‹è¼¸å…¥æœ‰æ•ˆçš„é‡‘é¡ï¼");
        return;
      }

      const record = {
        id: Date.now().toString(),
        rmb: rmbVal,
        twd: Math.round(twdVal),
        desc: desc,
        time: new Date().toLocaleString('zh-TW', { month: 'numeric', day: 'numeric', hour: '2-digit', minute: '2-digit' })
      };

      expenses.push(record);
      localStorage.setItem('expense_records', JSON.stringify(expenses));

      // æ¸…ç©ºè¼¸å…¥æ¡†
      rmbInput.value = '';
      twdInput.value = '';
      descInput.value = '';

      renderExpenses();
    }

    function removeExpense(id) {
      if (!confirm("ç¢ºå®šè¦åˆªé™¤é€™ç­†ç´€éŒ„å—ï¼Ÿ")) return;
      expenses = expenses.filter(e => e.id !== id);
      localStorage.setItem('expense_records', JSON.stringify(expenses));
      renderExpenses();
    }

    function clearExpenses() {
      if (!confirm("ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰è¨˜å¸³ç´€éŒ„å—ï¼Ÿé€™ç„¡æ³•å¾©åŸï¼")) return;
      expenses = [];
      localStorage.removeItem('expense_records');
      renderExpenses();
    }

    function renderExpenses() {
      const listEl = document.getElementById('expense-list-container');
      const totalRmbEl = document.getElementById('ep-total-rmb');
      const totalTwdEl = document.getElementById('ep-total-twd');

      let totalRmb = 0;
      let totalTwd = 0;

      if (expenses.length === 0) {
        listEl.innerHTML = '<div style="text-align:center; padding:20px; color:#9CA3AF; font-size:13px;">å°šç„¡è¨˜å¸³ç´€éŒ„ï¼Œé»ä¸Šæ–¹æ–°å¢å§ï¼</div>';
      } else {
        listEl.innerHTML = expenses.map(e => {
          totalRmb += e.rmb;
          totalTwd += e.twd;
          return `
            < div class="expense-item" >
              <div class="expense-item-info">
                <span class="expense-item-desc">${e.desc}</span>
                <span class="expense-item-time">${e.time}</span>
              </div>
              <div style="display:flex; align-items:center;">
                <div class="expense-item-amount">
                  <div class="expense-item-twd">NT$${e.twd}</div>
                  <div class="expense-item-rmb">Â¥${e.rmb.toFixed(2)}</div>
                </div>
                <button class="expense-item-delete" onclick="removeExpense('${e.id}')">âœ•</button>
              </div>
            </div >
            `;
        }).reverse().join('');
      }

      totalRmbEl.innerText = `Â¥ ${totalRmb.toFixed(2)} `;
      totalTwdEl.innerText = `NT$ ${totalTwd} `;
    }

    // ===== è¨­å®šé¢æ¿é‚è¼¯ =====
    function openSettings() {
      document.getElementById("settings-overlay").classList.add("open");
      // åŒæ­¥ç•«é¢ç‹€æ…‹
      syncSettingsUI();
    }

    function closeSettings() {
      document.getElementById("settings-overlay").classList.remove("open");
    }

    /** æ·±è‰²æ¨¡å¼åˆ‡æ› */
    function toggleDarkMode() {
      const isDark = document.body.classList.toggle("dark-mode");
      localStorage.setItem("pref_darkMode", isDark ? "1" : "0");
      document
        .getElementById("toggle-dark")
        .classList.toggle("active", isDark);
    }

    /** å­—å‹å¤§å°èª¿æ•´ */
    function setFontSize(size) {
      document.body.classList.remove(
        "font-small",
        "font-medium",
        "font-large",
      );
      document.body.classList.add("font-" + size);
      localStorage.setItem("pref_fontSize", size);
      // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
      ["small", "medium", "large"].forEach((s) => {
        const btn = document.getElementById("fs-" + s);
        if (btn) btn.classList.toggle("active", s === size);
      });
    }

    /** é‡æ–°è¼‰å…¥å¤©æ°£ */
    function refreshWeather() {
      WEATHER_LOCATIONS.forEach((loc) => {
        const cardEl = document.getElementById(loc.id);
        if (cardEl) {
          cardEl.innerHTML = `< div class="wc-city" > ${loc.name}</div > <div class="wc-loading">â˜• è¼‰å…¥ä¸­...</div>`;
        }
        fetchWeather(loc);
      });
      alert("å¤©æ°£è³‡æ–™å·²é‡æ–°è¼‰å…¥ï¼");
    }

    /** æ¸…é™¤æ‰€æœ‰å¿«å– */
    function clearAllCache() {
      const keys = Object.keys(localStorage);
      let count = 0;
      keys.forEach((key) => {
        if (key.startsWith("flight_")) {
          localStorage.removeItem(key);
          count++;
        }
      });
      alert(`å·²æ¸…é™¤ ${count} ç­†èˆªç­å¿«å–è³‡æ–™ï¼`);
    }

    /** åŒæ­¥è¨­å®šé¢æ¿çš„ UI ç‹€æ…‹ï¼ˆä¾‹å¦‚é–‹é—œã€å­—å‹å¤§å°æŒ‰éˆ•ï¼‰ */
    function syncSettingsUI() {
      const isDark = document.body.classList.contains("dark-mode");
      document
        .getElementById("toggle-dark")
        .classList.toggle("active", isDark);

      const fontSize = localStorage.getItem("pref_fontSize") || "medium";
      ["small", "medium", "large"].forEach((s) => {
        const btn = document.getElementById("fs-" + s);
        if (btn) btn.classList.toggle("active", s === fontSize);
      });
    }

    /** é é¢è¼‰å…¥æ™‚å¥—ç”¨å„²å­˜çš„åå¥½è¨­å®š */
    (function applyStoredPreferences() {
      // æ·±è‰²æ¨¡å¼
      if (localStorage.getItem("pref_darkMode") === "1") {
        document.body.classList.add("dark-mode");
      }
      // å­—å‹å¤§å°
      const fontSize = localStorage.getItem("pref_fontSize");
      if (fontSize && ["small", "medium", "large"].includes(fontSize)) {
        document.body.classList.add("font-" + fontSize);
      }
    })();

    // ===== Open-Meteo å³æ™‚å¤©æ°£æŸ¥è©¢ =====
    // ä½¿ç”¨ Open-Meteo APIï¼ˆå…è²»ã€ç„¡éœ€ API Keyã€æ”¯æ´ HTTPSã€å…¨çƒè¦†è“‹ï¼‰
    // ä¸­å¤®æ°£è±¡å±€ (CWA) åƒ…æ¶µè“‹å°ç£åœ°å€ï¼Œç„¡æ³•æŸ¥è©¢ä¸­åœ‹å¤§é™¸å¤©æ°£
    const WEATHER_LOCATIONS = [
      { id: "weather-chengdu", name: "æˆéƒ½å¸‚å€", lat: 30.57, lon: 104.07 },
      { id: "weather-jiuzhai", name: "ä¹å¯¨æº", lat: 33.26, lon: 103.92 },
      { id: "weather-huanglong", name: "é»ƒé¾", lat: 32.73, lon: 103.83 },
      { id: "weather-dujiangyan", name: "éƒ½æ±Ÿå °", lat: 31.0, lon: 103.62 },
    ];

    /**
     * WMO å¤©æ°£ä»£ç¢¼è½‰æ›ç‚º Emoji åœ–ç¤ºèˆ‡ä¸­æ–‡æè¿°
     * åƒè€ƒï¼šhttps://open-meteo.com/en/docs#weathervariables
     */
    function getWeatherInfo(code) {
      const map = {
        0: { icon: "â˜€ï¸", desc: "æ™´å¤©" },
        1: { icon: "ğŸŒ¤ï¸", desc: "å¤§è‡´æ™´æœ—" },
        2: { icon: "â›…", desc: "å±€éƒ¨å¤šé›²" },
        3: { icon: "â˜ï¸", desc: "å¤šé›²" },
        45: { icon: "ğŸŒ«ï¸", desc: "éœ§" },
        48: { icon: "ğŸŒ«ï¸", desc: "éœ°éœ§" },
        51: { icon: "ğŸŒ¦ï¸", desc: "å°æ¯›æ¯›é›¨" },
        53: { icon: "ğŸŒ¦ï¸", desc: "æ¯›æ¯›é›¨" },
        55: { icon: "ğŸŒ§ï¸", desc: "å¯†é›†æ¯›æ¯›é›¨" },
        56: { icon: "ğŸŒ§ï¸", desc: "å‡æ¯›æ¯›é›¨" },
        57: { icon: "ğŸŒ§ï¸", desc: "å¯†é›†å‡æ¯›æ¯›é›¨" },
        61: { icon: "ğŸŒ§ï¸", desc: "å°é›¨" },
        63: { icon: "ğŸŒ§ï¸", desc: "ä¸­é›¨" },
        65: { icon: "ğŸŒ§ï¸", desc: "å¤§é›¨" },
        66: { icon: "ğŸŒ§ï¸", desc: "å‡é›¨" },
        67: { icon: "ğŸŒ§ï¸", desc: "å¯†é›†å‡é›¨" },
        71: { icon: "ğŸŒ¨ï¸", desc: "å°é›ª" },
        73: { icon: "ğŸŒ¨ï¸", desc: "ä¸­é›ª" },
        75: { icon: "â„ï¸", desc: "å¤§é›ª" },
        77: { icon: "ğŸŒ¨ï¸", desc: "é›ªç²’" },
        80: { icon: "ğŸŒ¦ï¸", desc: "å°é™£é›¨" },
        81: { icon: "ğŸŒ§ï¸", desc: "ä¸­é™£é›¨" },
        82: { icon: "â›ˆï¸", desc: "æš´é›¨" },
        85: { icon: "ğŸŒ¨ï¸", desc: "å°é™£é›ª" },
        86: { icon: "â„ï¸", desc: "å¤§é™£é›ª" },
        95: { icon: "â›ˆï¸", desc: "é›·æš´" },
        96: { icon: "â›ˆï¸", desc: "é›·æš´+å†°é›¹(å°)" },
        99: { icon: "â›ˆï¸", desc: "é›·æš´+å†°é›¹(å¤§)" },
      };
      return map[code] || { icon: "ğŸŒ¡ï¸", desc: "æœªçŸ¥" };
    }

    /**
     * å–å¾—å–®ä¸€åœ°é»çš„å³æ™‚å¤©æ°£è³‡æ–™ä¸¦æ¸²æŸ“è‡³å¡ç‰‡
     */
    async function fetchWeather(location) {
      const cardEl = document.getElementById(location.id);
      if (!cardEl) return;

      try {
        const url = `https://api.open-meteo.com/v1/forecast?latitude=${location.lat}&longitude=${location.lon}&current=temperature_2m,relative_humidity_2m,weather_code,wind_speed_10m&timezone=Asia/Shanghai`;
        const response = await fetch(url);
        const data = await response.json();

        if (!data || !data.current) {
          cardEl.innerHTML = `
            <div class="wc-city">${location.name}</div>
            <div class="wc-loading">âš ï¸ ç„¡æ³•å–å¾—</div>`;
          return;
        }

        const current = data.current;
        const weatherInfo = getWeatherInfo(current.weather_code);

        cardEl.innerHTML = `
          <div class="wc-city">${location.name}</div>
          <div class="wc-icon">${weatherInfo.icon}</div>
          <div class="wc-temp">${Math.round(current.temperature_2m)}Â°C</div>
          <div class="wc-desc">${weatherInfo.desc}</div>
          <div class="wc-details">
            <span>ğŸ’§ ${current.relative_humidity_2m}%</span>
            <span>ğŸ’¨ ${current.wind_speed_10m} km/h</span>
          </div>`;
      } catch (err) {
        console.error(`å¤©æ°£æŸ¥è©¢å¤±æ•—: ${location.name}`, err);
        cardEl.innerHTML = `
          <div class="wc-city">${location.name}</div>
          <div class="wc-loading">âš ï¸ è¼‰å…¥å¤±æ•—</div>`;
      }
    }

    // é é¢è¼‰å…¥å¾Œè‡ªå‹•å–å¾—æ‰€æœ‰åœ°é»çš„å¤©æ°£
    WEATHER_LOCATIONS.forEach((loc) => fetchWeather(loc));

    // ===== Aviationstack API èˆªç­è©³æƒ…æŸ¥è©¢ =====
    const AVIATIONSTACK_KEY = "4e6b9230157d7292916389ff7e13289f";
    const CACHE_TTL = 10 * 60 * 1000; // å¿«å– 10 åˆ†é˜ï¼Œé¿å…æµªè²»å…è²»æ–¹æ¡ˆçš„ 100 æ¬¡/æœˆé¡åº¦

    /**
     * æŸ¥è©¢æŒ‡å®šèˆªç­çš„è©³ç´°è³‡è¨Šï¼ˆç™»æ©Ÿå£ã€èˆªå»ˆã€è¡Œæè½‰ç›¤ç­‰ï¼‰
     * @param {string} flightIata - èˆªç­ IATA ä»£ç¢¼ï¼Œä¾‹å¦‚ 'CX449'
     */
    async function queryFlightDetails(flightIata) {
      const panelEl = document.getElementById(`panel-${flightIata}`);
      const btnEl = document.getElementById(`query-btn-${flightIata}`);

      // è‹¥é¢æ¿å·²å±•é–‹ï¼Œå‰‡æ”¶åˆï¼ˆToggle æ•ˆæœï¼‰
      if (panelEl && panelEl.classList.contains("open")) {
        panelEl.classList.remove("open");
        return;
      }

      if (btnEl) {
        btnEl.disabled = true;
        btnEl.innerHTML = "ğŸ”„ æŸ¥è©¢ä¸­...";
      }

      try {
        // 1. å…ˆæª¢æŸ¥ localStorage å¿«å–æ˜¯å¦æœ‰æ•ˆ
        const cacheKey = `flight_${flightIata}`;
        const cached = localStorage.getItem(cacheKey);
        if (cached) {
          const cacheData = JSON.parse(cached);
          if (Date.now() - cacheData.timestamp < CACHE_TTL) {
            renderFlightPanel(panelEl, cacheData.data, flightIata);
            resetQueryButton(btnEl);
            return;
          }
        }

        // 2. å‘¼å« aviationstack APIï¼ˆå…è²»æ–¹æ¡ˆåƒ…æ”¯æ´ HTTPï¼Œä½¿ç”¨ AllOrigins proxy ç¹é HTTPS é™åˆ¶ï¼‰
        const targetUrl = `http://api.aviationstack.com/v1/flights?access_key=${AVIATIONSTACK_KEY}&flight_iata=${flightIata}`;
        const url = `https://api.allorigins.win/raw?url=${encodeURIComponent(targetUrl)}`;
        const response = await fetch(url);
        const result = await response.json();

        if (!result || !result.data || result.data.length === 0) {
          renderFlightPanel(panelEl, null, flightIata);
          resetQueryButton(btnEl);
          return;
        }

        // å–æœ€æ–°çš„é‚£ç­†ï¼ˆé€šå¸¸æ˜¯ç•¶å¤©æˆ–æœ€è¿‘çš„èˆªç­ï¼‰
        const flight = result.data[0];

        // 3. å­˜å…¥ localStorage å¿«å–
        localStorage.setItem(
          cacheKey,
          JSON.stringify({
            timestamp: Date.now(),
            data: flight,
          }),
        );

        renderFlightPanel(panelEl, flight, flightIata);
      } catch (err) {
        console.error("Aviationstack API è«‹æ±‚å¤±æ•—", err);
        if (panelEl) {
          panelEl.innerHTML = `
            <div class="detail-grid">
              <div class="detail-item full-width" style="text-align:center;">
                <div class="detail-label">âš ï¸ æŸ¥è©¢å¤±æ•—</div>
                <div class="detail-value" style="font-size:12px;color:#DC2626;">
                  ç„¡æ³•å–å¾—èˆªç­è³‡æ–™ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚<br>
                  <span style="font-size:10px;color:#9CA3AF;">(å¦‚æŒçºŒå¤±æ•—ï¼Œè«‹ç¢ºèªèˆªç­ä»£ç¢¼æ˜¯å¦æ­£ç¢ºï¼Œæˆ– API å‘¼å«æ¬¡æ•¸æ˜¯å¦é”æ¨™)</span>
                </div>
              </div>
            </div>`;
          panelEl.classList.add("open");
        }
      } finally {
        resetQueryButton(btnEl);
      }
    }

    /**
     * å°‡ aviationstack å›å‚³çš„èˆªç­è³‡æ–™æ¸²æŸ“æˆå±•é–‹é¢æ¿
     * @param {HTMLElement} panelEl - é¢æ¿ DOM å…ƒç´ 
     * @param {Object|null} flight - aviationstack å›å‚³çš„èˆªç­ç‰©ä»¶
     * @param {string} flightIata - èˆªç­ IATA ä»£ç¢¼
     */
    function renderFlightPanel(panelEl, flight, flightIata) {
      if (!panelEl) return;

      // è‹¥ API æ‰¾ä¸åˆ°è³‡æ–™
      if (!flight) {
        panelEl.innerHTML = `
          <div class="detail-grid">
            <div class="detail-item full-width" style="text-align:center;">
              <div class="detail-label">ğŸ“‹ èˆªç­ ${flightIata}</div>
              <div class="detail-value" style="font-size:12px;color:#D97706;">
                ç›®å‰æŸ¥ç„¡æ­¤èˆªç­å³æ™‚è³‡è¨Š<br>
                <span style="font-size:10px;color:#9CA3AF;">(å¯èƒ½å°šæœªç™¼ä½ˆæ™‚åˆ»è¡¨æˆ–éç•¶æ—¥èˆªç­)</span>
              </div>
            </div>
          </div>`;
        panelEl.classList.add("open");
        return;
      }

      // è§£æå„æ¬„ä½ï¼ˆé˜²å‘†ï¼šä»»ä½•æ¬„ä½éƒ½å¯èƒ½æ˜¯ nullï¼‰
      const dep = flight.departure || {};
      const arr = flight.arrival || {};
      const airline = flight.airline || {};
      const aircraft = flight.aircraft || {};
      const status = flight.flight_status || "æœªçŸ¥";

      // èˆªç­ç‹€æ…‹å°æ‡‰çš„ä¸­æ–‡èˆ‡ CSS class
      const statusMap = {
        scheduled: { text: "å·²æ’å®š", cls: "status-scheduled" },
        active: { text: "é£›è¡Œä¸­", cls: "status-active" },
        landed: { text: "å·²é™è½", cls: "status-landed" },
        cancelled: { text: "å·²å–æ¶ˆ", cls: "status-cancelled" },
        incident: { text: "äº‹æ•…", cls: "status-cancelled" },
        diverted: { text: "å·²è½‰é™", cls: "status-cancelled" },
      };
      const statusInfo = statusMap[status] || { text: status, cls: "" };

      // çµ„åˆå‡ºç™¼å»¶èª¤æç¤º
      const depDelay = dep.delay ? `âš ï¸ å»¶èª¤ ${dep.delay} åˆ†é˜` : "æº–æ™‚";
      const arrDelay = arr.delay ? `âš ï¸ å»¶èª¤ ${arr.delay} åˆ†é˜` : "æº–æ™‚";
      const depDelayClass = dep.delay ? "has-delay" : "";
      const arrDelayClass = arr.delay ? "has-delay" : "";

      panelEl.innerHTML = `
        <div class="detail-grid">
          <!-- èˆªç­ç‹€æ…‹ -->
          <div class="detail-item full-width">
            <div class="detail-label">ğŸŸ¢ èˆªç­ç‹€æ…‹</div>
            <div class="detail-value ${statusInfo.cls}">${statusInfo.text}</div>
          </div>

          <!-- å‡ºç™¼è³‡è¨Š -->
          <div class="detail-item">
            <div class="detail-label">ğŸšª å‡ºç™¼ç™»æ©Ÿå£</div>
            <div class="detail-value">${dep.gate || "å¾…å…¬ä½ˆ"}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">ğŸ¢ å‡ºç™¼èˆªå»ˆ</div>
            <div class="detail-value">${dep.terminal ? "T" + dep.terminal : "å¾…å…¬ä½ˆ"}</div>
          </div>

          <!-- æŠµé”è³‡è¨Š -->
          <div class="detail-item">
            <div class="detail-label">ğŸ›¬ æŠµé”ç™»æ©Ÿå£</div>
            <div class="detail-value">${arr.gate || "å¾…å…¬ä½ˆ"}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">ğŸ¢ æŠµé”èˆªå»ˆ</div>
            <div class="detail-value">${arr.terminal ? "T" + arr.terminal : "å¾…å…¬ä½ˆ"}</div>
          </div>

          <!-- è¡Œæè½‰ç›¤ -->
          <div class="detail-item">
            <div class="detail-label">ğŸ§³ è¡Œæè½‰ç›¤</div>
            <div class="detail-value">${arr.baggage || "å¾…å…¬ä½ˆ"}</div>
          </div>

          <!-- æ©Ÿå‹ -->
          <div class="detail-item">
            <div class="detail-label">âœˆï¸ æ©Ÿå‹</div>
            <div class="detail-value">${aircraft.iata || "å¾…å…¬ä½ˆ"}</div>
          </div>

          <!-- å»¶èª¤ç‹€æ…‹ -->
          <div class="detail-item">
            <div class="detail-label">â± å‡ºç™¼å»¶èª¤</div>
            <div class="detail-value ${depDelayClass}">${depDelay}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">â± æŠµé”å»¶èª¤</div>
            <div class="detail-value ${arrDelayClass}">${arrDelay}</div>
          </div>
        </div>
        <div class="panel-note">è³‡æ–™ä¾†æºï¼šaviationstack Â· å¿«å– 10 åˆ†é˜è‡ªå‹•æ›´æ–°</div>
      `;
      panelEl.classList.add("open");
    }

    /**
     * é‡ç½®ã€ŒæŸ¥è©¢è©³æƒ…ã€æŒ‰éˆ•å›åˆå§‹ç‹€æ…‹
     */
    function resetQueryButton(btnEl) {
      if (btnEl) {
        btnEl.disabled = false;
        btnEl.innerHTML = "ğŸ“‹ æŸ¥è©¢è©³æƒ…";
      }
    }

    // ===== å€’æ•¸è¨ˆæ™‚å™¨é‚è¼¯ =====
    function updateCountdown() {
      // æ—…éŠé–‹å§‹æ™‚é–“ï¼š2026å¹´5æœˆ16æ—¥ 00:00:00
      const targetDate = new Date("2026-05-16T00:00:00+08:00").getTime();
      const now = new Date().getTime();
      const distance = targetDate - now;

      const countdownEl = document.getElementById("trip-countdown");
      const valueEl = document.getElementById("countdown-value");

      if (distance < 0) {
        // å·²ç¶“å‡ºç™¼
        countdownEl.style.display = "none";
        return;
      }

      countdownEl.style.display = "inline-flex";

      const days = Math.floor(distance / (1000 * 60 * 60 * 24));

      if (days > 0) {
        // å¤§æ–¼ 1 å¤©é¡¯ç¤º N Days
        valueEl.innerText = days + " Days";
      } else {
        // å°æ–¼ 1 å¤©é¡¯ç¤º HH:MM:SS
        const hours = Math.floor(
          (distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60),
        );
        const minutes = Math.floor(
          (distance % (1000 * 60 * 60)) / (1000 * 60),
        );
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);

        const formattedHours = String(hours).padStart(2, "0");
        const formattedMinutes = String(minutes).padStart(2, "0");
        const formattedSeconds = String(seconds).padStart(2, "0");

        valueEl.innerText = `${formattedHours}:${formattedMinutes}:${formattedSeconds}`;
      }
    }

    // åˆå§‹åŒ–å€’æ•¸è¨ˆæ™‚ä¸¦æ¯ç§’æ›´æ–°
    updateCountdown();
    setInterval(updateCountdown, 1000);

    // ===== ä½å®¿æŠ˜ç–Šé¢æ¿é‚è¼¯ =====
    function toggleHotelDetail(headerEl) {
      const panelEl = headerEl.nextElementSibling;
      const isOpen = panelEl.classList.contains('open');

      // é—œé–‰æ‰€æœ‰çš„é¢æ¿
      document.querySelectorAll('.hotel-detail-panel').forEach(el => {
        el.classList.remove('open');
      });
      document.querySelectorAll('.hotel-card').forEach(el => {
        el.classList.remove('active');
        const arrow = el.querySelector('.hotel-arrow');
        if (arrow) arrow.style.transform = 'rotate(0deg)';
      });

      // å¦‚æœåŸæœ¬ä¸æ˜¯é–‹çš„ï¼Œå‰‡æ‰“é–‹ä¸¦æ—‹è½‰ç®­é ­
      if (!isOpen) {
        panelEl.classList.add('open');
        headerEl.classList.add('active');
        const arrow = headerEl.querySelector('.hotel-arrow');
        if (arrow) arrow.style.transform = 'rotate(180deg)';
      }
    }

    // ===== PWA Service Worker è¨»å†Š =====
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js').then(registration => {
          console.log('ServiceWorker è¨»å†ŠæˆåŠŸ: ', registration.scope);
        }).catch(err => {
          console.log('ServiceWorker è¨»å†Šå¤±æ•—: ', err);
        });
      });
    }
  </script>
  <script>lucide.createIcons();</script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // æ»¾å‹•æ·¡å…¥å‹•ç•«
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
            observer.unobserve(entry.target);
          }
        });
      }, { threshold: 0.1, rootMargin: "0px 0px -20px 0px" });

      document.querySelectorAll('.day-card, .tl-item, .hotel-card, .tips-card, .weather-card, .stats-bar, .map-section, .booking-item').forEach(el => {
        el.classList.add('fade-up');
        observer.observe(el);
      });

      // è¦–å·®æ»¾å‹• (Parallax)
      const heroBanners = document.querySelectorAll('.hero, .banner');
      window.addEventListener('scroll', () => {
        const scrolled = window.scrollY;
        heroBanners.forEach(banner => {
          banner.style.backgroundPositionY = calc(50 % + px);
        });
      });
    });
  </script>
</body>

</html>